<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fits a generalized linear model using cumulative history and
specified fixed effects."><title>Fits cumulative history for bistable perceptual rivalry displays. — fit_cumhist • bistablehistory</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fits cumulative history for bistable perceptual rivalry displays. — fit_cumhist"><meta property="og:description" content="Fits a generalized linear model using cumulative history and
specified fixed effects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bistablehistory</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/cumulative-history.html">Cumulative History</a>
    <a class="dropdown-item" href="../articles/usage-examples.html">Usage examples</a>
    <a class="dropdown-item" href="../articles/writing-stan-code.html">Writing Stan code</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexander-pastukhov/bistablehistory/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fits cumulative history for bistable perceptual rivalry displays.</h1>
      <small class="dont-index">Source: <a href="https://github.com/alexander-pastukhov/bistablehistory/blob/HEAD/R/fit_cumhist.R" class="external-link"><code>R/fit_cumhist.R</code></a></small>
      <div class="d-none name"><code>fit_cumhist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a generalized linear model using cumulative history and
specified fixed effects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_cumhist</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">state</span>,</span>
<span>  duration <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  onset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  random_effect <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  session <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  run <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fixed_effects <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tau <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mixed_state <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  history_init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  history_priors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  intercept_priors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  history_effect_prior <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fixed_effects_priors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A table with time-series.</p></dd>


<dt>state</dt>
<dd><p>String, the name of the column that specifies
perceptual state. The column type should be a factor with
two or three levels (the third level is assumed to correspond to a
transition/mixed phase) or should be convertible to a two level
factor (as it would be impossible to infer the identity of transition/
mixed phase).</p></dd>


<dt>duration</dt>
<dd><p>String, name of the column with duration of individual
perceptual dominance phases. Optional, you can specify <code>onset</code>
instead.</p></dd>


<dt>onset</dt>
<dd><p>String, name of the column with onsets of the perceptual
dominance states. Optional, used to compute duration of the dominance
phases, if these are not provided explicitly via <code>duration</code>
parameter.</p></dd>


<dt>random_effect</dt>
<dd><p>String, name of the column that identifies random
effect, e.g. individual participants, stimuli for a single participant,
etc. If omitted, no random effect is assumed. If specified and
there is more than one level (participant, stimulus, etc.), it is used
in a hierarchical model.</p></dd>


<dt>session</dt>
<dd><p>String, name of the column that identifies unique
experimental session for which a mean dominance phase duration will
be computed (see <code>norm_tau</code> parameter). Code assumes that session
IDs are different within a participant but can be the same between them.
If omitted, a single mean dominance duration based on the entire time series
is used.</p></dd>


<dt>run</dt>
<dd><p>String, name of the column that identifies unique runs/blocks.
If omitted, the data is assumed to belong to a single time series. Code
assumes that run IDs are different within an experimental session but
can be the same between the session. E.g. session A, runs 1, 2, 3.. and
session B, runs 1, 2, 3 but not session A, runs 1, 2, 1.</p></dd>


<dt>fixed_effects</dt>
<dd><p>String or vector of strings. Name of column(s)
with values to be used for fitting an additional fixed effect(s). E.g.,
contrast in binocular rivalry, rotation speed for kinetic-depth effect,
etc.</p></dd>


<dt>tau</dt>
<dd><p>Time constant of exponential growth/decay
normalized to the mean duration of clear percepts within each <code>session</code>.
Can be 1) a single positive number (&gt;0) that is used for all participants and runs,
2) <code>NULL</code> (default) -  a <em>single</em> value will be fitted for all participants and runs,
3) <code>"random"</code> - an independent tau is fitted for each random cluster,
4) <code>"1|random"</code>- a tau for a random cluster
is sampled from a population distribution, i.e., pooled parameter values via
a multilevel model.</p></dd>


<dt>mixed_state</dt>
<dd><p>Specifies an activation level during
transition/mixed phases (state #3, see <code>state</code>). Either a single
number (range 0..1) that will be used as a fixed level or a vector
of two numbers <code>c(mu, kappa)</code> that specifies, correspondingly, mean
(range 0..1) and precision (&gt;0) of beta proportion distribution, it
should be sampled from. Defaults to a fixed value of <code>0.5</code>.</p></dd>


<dt>history_init</dt>
<dd><p>Initial value for cumulative history computation. Either
a numeric scalar in 0..1 range or a vector of two numbers in 0..1 range.
In the latter case, two histories will start at different levels.</p></dd>


<dt>family</dt>
<dd><p>String, distribution used to fit duration of perceptual dominance
phases. Options include <code>"gamma"</code> (default), <code>"lognormal"</code>, and <code>"normal"</code>.</p></dd>


<dt>history_priors</dt>
<dd><p>Named list of optional priors for population-level cumulative history
parameters. Must follow the format <code>list("tau"=c(1, 0.15))</code> with values coding mean
and standard deviation of the normal distribution.</p></dd>


<dt>intercept_priors</dt>
<dd><p>A vector of optional priors for population-level intercept
parameter. Should be <code>c(&lt;shape-mean&gt;, &lt;shape-sd&gt;, &lt;scale-mean&gt;, &lt;scale-sd&gt;)</code>
format for Gamma family, <code>c(&lt;mean&gt;, &lt;sd&gt;)</code> for normal and lognormal families.
The values code mean and standard deviation of the normal distribution.</p></dd>


<dt>history_effect_prior</dt>
<dd><p>A vector of options priors for population-level slope
of history effect. The values code mean and standard deviation of the normal distribution.
Defaults to mu=0, sigma=1.</p></dd>


<dt>fixed_effects_priors</dt>
<dd><p>A named list of optional priors for fixed effects. Must
follow the format <code>list("&lt;name-of-variable&gt;"=c(&lt;mu&gt;, &lt;sigma&gt;))</code>, where <code>&lt;mu&gt;</code> and
<code>&lt;sigma&gt;</code> are mean and standard deviation of a normal distribution. Defaults to mu=0,
sigma=1.</p></dd>


<dt>chains</dt>
<dd><p>Number of chains for sampling.</p></dd>


<dt>cores</dt>
<dd><p>Number of CPU cores to use for sampling. If omitted, All cores are used.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to rstan::sampling() function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <a href="cumhist-class.html">cumhist</a></p>


    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">br_singleblock</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gamma_fit</span> <span class="op">&lt;-</span> <span class="fu">fit_cumhist</span><span class="op">(</span><span class="va">br_singleblock</span>, state <span class="op">=</span> <span class="st">"State"</span>, duration <span class="op">=</span> <span class="st">"Duration"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 0 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 4.518 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                4.537 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                9.055 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://alexander-pastukhov.github.io/" class="external-link">Alexander Pastukhov</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>


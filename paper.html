<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Summary • bistablehistory</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Summary"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">bistablehistory</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/cumulative-history.html">Cumulative History</a>
    <a class="dropdown-item" href="articles/usage-examples.html">Usage examples</a>
    <a class="dropdown-item" href="articles/writing-stan-code.html">Writing Stan code</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexander-pastukhov/bistablehistory/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Summary</h1>
      <small class="dont-index">Source: <a href="https://github.com/alexander-pastukhov/bistablehistory/blob/HEAD/paper.md" class="external-link"><code>paper.md</code></a></small>
    </div>


<div id="summary" class="section level1">

<p>Our perception is subject to a process of adaptation that changes its operating properties [@Clifford2007]. This process manifests itself in a plethora of perceptual illusions and so-called aftereffects. It also plays an important role during the perception of multistable stimuli, such as a Necker cube (Fig. 1A). These are compatible with several, typically two, comparably likely perceptual interpretations. In the case of the Necker cube, one can perceive it as “upwards” or “downwards”, and during continuous viewing the perception switches between these alternatives (Fig. 1B).</p>
<div class="figure">
<img src="fig1.png" style="width:80.0%" alt=""><p class="caption"><strong>Figure 1. Perception of Necker cube stimulus.</strong> A) Necker cube. B) Schematic time series of perceptual alternations. C) Example distribution of perceptual dominance phases’ duration fitting with Gamma distribution. </p>
</div>
<p>Typically, time series for such multistable stimuli are fitted using Gamma distribution (Fig. 1C). This assumes that individual dominance phase durations are exchangeable, i.e., the order in which they are drawn is unimportant. However, this ignores the effect of prior perception through adaptation [@VanEe2009] that makes individual dominance phases serially dependent on prior ones, violating assumptions about independent and identically distributed samples. In other words, each dominance phase is drawn from its specific distribution, whose parameters are also determined by the prior perceptual history. The <code>bistablehistory</code> package solves this problem by accounting for the slow accumulation process via a homogeneous first-order process [@PastukhovBraun2011], providing tools for fitting time series using various distributions. It also allows for fitting while accounting for additional random or fixed factors. In addition, it provides a tool for extracting the estimated accumulated adaptation or computing it directly for further usage. The package aims to streamline the time series analysis for perceptual multistability and experiments on continuous perception in general.</p>
<p>The package is built using Stan probabilistic programming language [@carpenter2017stan]. Thus, it provides posterior distributions, the ability to compare models via information criteria [@loo], etc. In addition, the package provides Stan code for performing the estimation and an example that explains how to implement a custom Stan model that relies on it. The source code for <code>bistablehistory</code> has been archived to Zenodo with the linked DOI: [@zenodo]</p>
</div>
<div class="section level1">
<h1 id="statement-of-need">Statement of Need<a class="anchor" aria-label="anchor" href="#statement-of-need"></a></h1>
<p>Analysis of time series from psychophysical experiments, particularly on multistable perception, frequently requires taking into account the slow accumulation of adaptation. R has an extensive toolset for working with time-series, e.g., see <a href="https://cran.r-project.org/web/views/TimeSeries.html" class="external-link">cran.r-project.org/web/views/TimeSeries.html</a>, using frequentist [@forecast] and Bayesian [@varstan] approaches. The purpose of <em>bistablehistory</em> package is to extend the existing tools by incorporating fitting of cumulative history via a homogeneous first-order process, which is more accurate [@PastukhovBraun2011] than commonly used approximation via an autocorrelation coefficient [@VanEe2009]. The package simplifies both computing cumulative history and its use directly as part of a statistical (generalized) linear model fitted by a package function.</p>
</div>
<div class="section level1">
<h1 id="cumulative-history-computation">Cumulative history computation<a class="anchor" aria-label="anchor" href="#cumulative-history-computation"></a></h1>
<p>The cumulative history for a perceptual state is computed via a homogeneous first-order process (for details on first order linear differential equations, please refer to chapter 2 in @Wilson1999): <span class="math display">$$\tag{1}\frac{dh_i}{dt} = \frac{1}{\tau} (-h_i + S_i(t))$$</span></p>
<p>where <span class="math inline"><em>τ</em></span> is the time constant, <span class="math inline"><em>h</em><sub><em>i</em></sub></span> is cumulative history and <span class="math inline"><em>S</em><sub><em>i</em></sub>(<em>t</em>)</span> is the current signal level for the i<sup>th</sup> perceptual state, so that <span class="math display">$$\tag{2}
S(t) = \begin{cases}
  1 &amp; \text{if state $i$ is dominant}\\
  0 &amp; \text{if state $i$ is suppessed}\\
  S_{mixed} &amp; \text{if it is a mixed/transition phase and $0 ≥ S_{mixed} ≥1 $}
\end{cases}$$</span></p>
<p>where <span class="math inline"><em>S</em><sub><em>m</em><em>i</em><em>x</em><em>e</em><em>d</em></sub></span> corresponds to the <code>mixed_state</code> parameter that can be either specified (the <code><a href="reference/fit_cumhist.html">fit_cumhist()</a></code> function uses a default of <code>0.5</code>) or fitted. The general solution for the equation (see Theorem 1 in @Wilson1999, chapter 2, page 15) is</p>
<p><span class="math display">$$\tag{3}h_i(t) = A e^{-t/\tau} + \frac{1}{\tau} \int_{0}^{t} e^{-(t'-t)/\tau} S(t') dt'$$</span></p>
<p>where <span class="math inline"><em>A</em></span> is chosen to satisfy the initial condition. Assuming a constant signal <span class="math inline"><em>S</em></span>, we obtain <span class="math display"><em>h</em><sub><em>i</em></sub>(<em>t</em>) = <em>A</em><em>e</em><sup>−<em>t</em>/<em>τ</em></sup> + <em>S</em><sub><em>i</em></sub> ⋅ (1−<em>e</em><sup>−<em>t</em>/<em>τ</em></sup>)</span></p>
<p>For the cumulative history, we are interested in <span class="math inline"><em>h</em><sub><em>i</em></sub>(<em>t</em>+<em>Δ</em><em>t</em>)</span>: a change following a dominance phase that starts at time <span class="math inline"><em>t</em></span>, ends at time <span class="math inline"><em>t</em> + <em>Δ</em><em>t</em></span>, and has a constant signal strength <span class="math inline"><em>S</em><sub><em>i</em></sub></span>. Assuming that a dominance phase starts at <span class="math inline"><em>t</em> = 0</span> and substituting into the equation 4, <span class="math inline"><em>h</em><sub><em>i</em></sub>(0) = <em>A</em></span>. In other words, constant <span class="math inline"><em>A</em></span> is equal to cumulative history state before the dominance phase onset and, therefore, the relative signal strength during the dominance phase is determined by the difference between the signal strength and the initial cumulative history value: <span class="math inline"><em>S</em><sub><em>i</em></sub> − <em>h</em><sub><em>i</em></sub>(0)</span>. Thus <span class="math display"><em>h</em><sub><em>i</em></sub>(<em>Δ</em><em>t</em>) = <em>h</em><sub><em>i</em></sub>(0) + (<em>S</em>−<em>h</em><sub><em>i</em></sub>(0)) ⋅ (1−<em>e</em><sup>−<em>Δ</em><em>t</em>/<em>τ</em></sup>)</span> <span class="math display"><em>h</em><sub><em>i</em></sub>(<em>Δ</em><em>t</em>) = <em>S</em> + (<em>h</em><sub><em>i</em></sub>(0)−<em>S</em>) ⋅ <em>e</em><sup>−<em>Δ</em><em>t</em>/<em>τ</em></sup></span></p>
<p>The figure below shows accumulation over time for three different initial values (<span class="math inline"><em>h</em>(0)</span>), signal strength (<span class="math inline"><em>S</em></span>), and time constants (<span class="math inline"><em>t</em><em>a</em><em>u</em></span>). Note that the package allows to either specify and fit both the time constant (argument <code>tau</code> in <code><a href="reference/fit_cumhist.html">fit_cumhist()</a></code> function) and the initial history value at the block (<code>history_init</code> argument).</p>
<div class="figure">
<img src="fig2.png" style="width:100.0%" alt=""><p class="caption"><strong>Figure 2. Cumulative history for different initial conditions, signal strength, and time constants.</strong> </p>
</div>
<p>For a bistable case, there are two history states, one for each perceptual state. Therefore, we compute a history as a difference of cumulative histories: <span class="math display"><em>Δ</em><em>h</em>(<em>t</em>,<em>τ</em>) = <em>h</em><sub><em>s</em><em>u</em><em>p</em><em>p</em><em>r</em><em>e</em><em>s</em><em>s</em><em>e</em><em>d</em></sub>(<em>t</em>,<em>τ</em>) − <em>h</em><sub><em>d</em><em>o</em><em>m</em><em>i</em><em>n</em><em>a</em><em>n</em><em>t</em></sub>(<em>t</em>,<em>τ</em>)</span> where <span class="math inline"><em>h</em><sub><em>d</em><em>o</em><em>m</em><em>i</em><em>n</em><em>a</em><em>n</em><em>t</em></sub></span> and <span class="math inline"><em>h</em><sub><em>s</em><em>u</em><em>p</em><em>p</em><em>r</em><em>e</em><em>s</em><em>s</em><em>e</em><em>d</em></sub></span> are history states for currently dominant and suppressed states, respectively. <em>E.g.</em>, if a left eye dominates during the following phase, <span class="math inline"><em>h</em><sub><em>d</em><em>o</em><em>m</em><em>i</em><em>n</em><em>a</em><em>n</em><em>t</em></sub> = <em>h</em><sub><em>l</em><em>e</em><em>f</em><em>t</em></sub></span> and <span class="math inline"><em>h</em><sub><em>s</em><em>u</em><em>p</em><em>p</em><em>r</em><em>e</em><em>s</em><em>s</em><em>e</em><em>d</em></sub> = <em>h</em><sub><em>r</em><em>i</em><em>g</em><em>h</em><em>t</em></sub></span> and vice versa.</p>
</div>
<div class="section level1">
<h1 id="usage-and-features">Usage and Features<a class="anchor" aria-label="anchor" href="#usage-and-features"></a></h1>
<p>The main function is <code><a href="reference/fit_cumhist.html">fit_cumhist()</a></code> which takes a data frame with time-series as a first argument. In addition, you need to specify the name of the column that codes the perceptual state (<code>state</code> argument) and a column that holds either dominance phase duration (<code>duration</code>) or its onset (<code>onset</code>). The code below is the simplest case scenario, fitting data using Gamma distribution (default family) for a single run of a single participant. By default, the function fits the time constant <span class="math inline"><em>τ</em></span> for slowly accumulating adaptation but uses default values for other parameters that influence history computation.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexander-pastukhov/bistablehistory" class="external-link">bistablehistory</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">br_singleblock</span><span class="op">)</span>
<span class="va">gamma_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit_cumhist.html">fit_cumhist</a></span><span class="op">(</span><span class="va">br_singleblock</span>,
                        state<span class="op">=</span><span class="st">"State"</span>,
                        duration<span class="op">=</span><span class="st">"Duration"</span>,
                        refresh<span class="op">=</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>Alternatively, one can specify the <em>onset</em> of individual dominance phases to compute their duration.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gamma_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit_cumhist.html">fit_cumhist</a></span><span class="op">(</span><span class="va">br_singleblock</span>,
                        state<span class="op">=</span><span class="st">"State"</span>,
                        onset<span class="op">=</span><span class="st">"Time"</span><span class="op">)</span></code></pre></div>
<p>Utility functions simplify extracting information about fitted parameters. For example, one can look at the fitted value for history time constant using <code><a href="reference/history_tau.html">history_tau()</a></code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/history_tau.html">history_tau</a></span><span class="op">(</span><span class="va">gamma_fit</span><span class="op">)</span></code></pre></div>
<p>or the main effect of history for both parameters of gamma distribution via</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/historyef.html">historyef</a></span><span class="op">(</span><span class="va">gamma_fit</span><span class="op">)</span></code></pre></div>
<p>extract an estimate of perceptual history / adaptation using <code><a href="reference/extract_history.html">extract_history()</a></code> function</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_history.html">extract_history</a></span><span class="op">(</span><span class="va">gam_fit</span><span class="op">)</span></code></pre></div>
<p>or compute an expected duration for each dominance phase via <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">br_singleblock</span><span class="op">$</span><span class="va">Predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gam_fit</span><span class="op">)</span></code></pre></div>
<p>The package extends the analysis to multiple experimental runs (via the <code>run</code> argument that specifies a variable that identifies individual runs), experimental session (via the <code>session</code> argument) that are assumed to have different average dominance phase durations [@Suzuki2007], to multiple participants (via <code>random_effect</code> argument). It also allows incorporating fixed effects, although they are restricted to continuous metric variables (see a vignette on reusing model code directly in Stan for overcoming these limitations).</p>
<p>The example below demonstrates an analysis for many observers (<code>random_effect = "Observer"</code>) who performed multiple runs (<code>run = "Block"</code>) taking into account when the dominance phase occurred (<code>fixed_effects = "LogTime"</code>). It also uses custom prior for <code>tau</code> parameter and custom control parameters for Stan sampler. Please refer to “Usage Examples” vignette for details on these and other settings.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexander-pastukhov/bistablehistory" class="external-link">bistablehistory</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">kde</span><span class="op">)</span>
<span class="va">kde</span><span class="op">$</span><span class="va">LogTime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">kde</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span>
<span class="va">kde_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit_cumhist.html">fit_cumhist</a></span><span class="op">(</span><span class="va">kde</span>,
                       state <span class="op">=</span> <span class="st">"State"</span>,
                       duration <span class="op">=</span> <span class="st">"Duration"</span>,
                       random_effect <span class="op">=</span> <span class="st">"Observer"</span>,
                       fixed_effects <span class="op">=</span> <span class="st">"LogTime"</span>,
                       run <span class="op">=</span> <span class="st">"Block"</span>,
                       tau <span class="op">=</span> <span class="st">"1|random"</span>,
                       history_priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"tau"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>,
                       chains <span class="op">=</span> <span class="fl">4</span>,
                       control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>max_treedepth <span class="op">=</span> <span class="fl">15</span>,
                                      adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Models fits can be compared via information criteria. Specifically, the log-likelihood is stored in a <code>log_lik</code> parameter that can be directly using <code><a href="https://mc-stan.org/loo/reference/extract_log_lik.html" class="external-link">loo::extract_log_lik()</a></code> function (see package [@@loo]) or used to compute either a leave-one-out cross-validation (via <code><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo()</a></code> convenience function) or WAIC (via <code><a href="https://mc-stan.org/loo/reference/waic.html" class="external-link">waic()</a></code>). These are information criteria that can be used for model comparison the same way as Akaike (AIC), Bayesian (BIC), or deviance (DIC) information criteria. The latter can also be computed from log-likelihood, but WAIC and LOOCV are both recommended for multi-level models, see [@loo]. The model comparison itself can be performed via <code><a href="https://mc-stan.org/loo/reference/loo_compare.html" class="external-link">loo::loo_compare()</a></code> function from the <code>loo</code> package.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/loo/" class="external-link">loo</a></span><span class="op">)</span>
<span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit_cumhist.html">fit_cumhist</a></span><span class="op">(</span><span class="va">br_singleblock</span>,
                    state<span class="op">=</span><span class="st">"State"</span>,
                    onset<span class="op">=</span><span class="st">"Time"</span><span class="op">)</span>
                        
<span class="va">br_singleblock</span><span class="op">$</span><span class="va">LogTime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">br_singleblock</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span>
<span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit_cumhist.html">fit_cumhist</a></span><span class="op">(</span><span class="va">br_singleblock</span>,
                    state<span class="op">=</span><span class="st">"State"</span>,
                    onset<span class="op">=</span><span class="st">"Time"</span>,
                    fixed_effects <span class="op">=</span> <span class="st">"LogTime"</span><span class="op">)</span>
                    
<span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html" class="external-link">loo_compare</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"null"</span> <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span>,
                      <span class="st">"+logTime"</span> <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h1>
</div>


  </main></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://alexander-pastukhov.github.io/" class="external-link">Alexander Pastukhov</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>


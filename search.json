[{"path":[]},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"minimal-example","dir":"Articles","previous_headings":"","what":"Minimal example","title":"Usage examples","text":"main function fit_cumhist() takes data frame time-series first argument. addition, need specify name column codes perceptual state (state argument) column holds either dominance phase duration (duration) onset (onset). code fits data using Gamma distribution (default family) single run single participant. default, function fits cumulative history time constant uses default fixed mixed state value (mixed_state = 0.5) initial history values (history_init = 0). Alternatively, specify onset individual dominance phases used compute duration. can look fitted value history time constant using history_tau() main effect history parameters gamma distribution following model fitted example , see also companion vignette details cumulative history computation. \\[Duration[] \\sim  Gamma(shape[], rate[]) \\\\ log(shape[]) = \\alpha^{shape} + \\beta^{shape}_H \\cdot \\Delta h[] \\\\ log(rate[]) = \\alpha^{rate} + \\beta^{rate}_H \\cdot \\Delta h[] \\\\ \\Delta h[] = \\text{cumulative_history}(\\tau, \\text{history_init})\\\\ \\alpha^{shape}, \\alpha^{rate} \\sim Normal(log(3), 5) \\\\ \\beta^{shape}_H, \\beta^{rate}_H \\sim Normal(0, 1) \\\\ \\tau \\sim Normal(log(1), 0.15)\\]","code":"library(bistablehistory)  data(br_singleblock) gamma_fit <- fit_cumhist(br_singleblock,                          state=\"State\",                          duration=\"Duration\",                          refresh=0) gamma_fit <- fit_cumhist(br_singleblock,                         state=\"State\",                         onset=\"Time\") history_tau(gamma_fit) #> # A tibble: 1 x 3 #>   Estimate `5.5%` `94.5%` #>      <dbl>  <dbl>   <dbl> #> 1    0.993  0.759    1.26 historyef(gamma_fit) #> # A tibble: 2 x 4 #>   DistributionParameter Estimate  `5.5%` `94.5%` #>   <fct>                    <dbl>   <dbl>   <dbl> #> 1 shape                    0.942 -0.0850    1.90 #> 2 scale                    0.396 -0.693     1.49"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"passing-stan-control-parameters","dir":"Articles","previous_headings":"","what":"Passing Stan control parameters","title":"Usage examples","text":"can pass Stan control parameters via control argument, e.g., See Stan documentation details (Carpenter et al. 2017).","code":"gamma_fit <- fit_cumhist(br_singleblock,                         state=\"State\",                         duration=\"Duration\",                         control=list(max_treedepth = 15,                                      adapt_delta = 0.99))"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"run","dir":"Articles","previous_headings":"","what":"Run","title":"Usage examples","text":"default, fit_cumhist() function assumes time-series represent single run, history states initialized beginning. can use run argument pass name column specifies individual runs. case, history initialized beginning every run avoid spill-effects.","code":"gamma_fit <- fit_cumhist(br_single_subject,                         state=\"State\",                         onset=\"Time\",                         run=\"Block\")"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"experimental-session","dir":"Articles","previous_headings":"","what":"Experimental session","title":"Usage examples","text":"Experimental session specifies time-series measured together used compute average dominance phase duration , turn, used computing cumulative history: \\(\\tau_H = \\tau \\cdot <D>\\), \\(\\tau\\) normalized time constant \\(<D>\\) mean dominance phase duration. can used account changes overall alternation rate different sessions (days), , example, participants new stimuli tend “speed ” course days (Suzuki Grabowecky 2007). specify session parameter single mean dominance phase duration computed runs single subject.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"random-effect","dir":"Articles","previous_headings":"","what":"Random effect","title":"Usage examples","text":"random_effect argument allows specify name column codes random effect, e.g., participant identity, bistable display (different displays used single participant), etc. specified, used fit hierarchical model random slopes history effect (\\(\\beta_H\\)). Note random independent intercepts used prior research suggest large differences overall alternation rate participants (Brascamp et al. 2019). , R code specifies participants random effect corresponding model, specified shape parameter identical formulas used rate parameter well. , \\(R_i\\) codes random effect level (participant identity) non-centered parametrization used pooled random slopes. \\[Duration[] \\sim  Gamma(shape[], rate[]) \\\\ log(shape[]) = \\alpha[R_i] + \\beta_H[R_i] \\cdot \\Delta h[] \\\\ \\Delta H[] = \\text{cumulative_history}(\\tau, \\text{history_init})\\\\ \\alpha[R_i] \\sim Normal(log(3), 5) \\\\ \\beta_H[R_i] = \\beta^{pop}_H + \\beta^{z}_H[R_i] \\cdot \\sigma^{pop}_H\\\\ \\beta^{pop}_H \\sim Normal(0, 1) \\\\ \\beta^{z}_H[R_i] \\sim Normal(0, 1) \\\\ \\sigma^{pop}_H \\sim Exponential(1) \\\\ \\tau \\sim Normal(log(1), 0.15)\\] Identical approach take \\(\\tau\\), tau=' \"1|random\"' specified holds mixed_state=' \"1|random\"' argument, see .","code":"gamma_fit <-  fit_cumhist(kde_two_observers,                           state=\"State\",                           duration=\"Duration\",                           random_effect=\"Observer\",                           run=\"Block\")"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"fixed-effects","dir":"Articles","previous_headings":"","what":"Fixed effects","title":"Usage examples","text":"fit_cumhist() functions allows specify multiple fixed effect terms vector strings. implementation restricted : continuous (metric) independent variables used. single value fitted main effect, irrespective whether random effect specified. specify interaction either fixed effects fixed effect cumulative history variable. Although limits usability fixed effects, restrictions allowed simpler model specification simpler underlying code. require complex models, please refer companion vignette provides example writing model using Stan directly. can specify custom priors (mean standard deviation prior normal distribution) via history_effect_prior fixed_effects_priors arguments. former accepts vector mean standard deviation, whereas latter takes named list format . fitted, can use fixef() function extract posterior distribution summary effect.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"cumulative-history-parameters","dir":"Articles","previous_headings":"","what":"Cumulative history parameters","title":"Usage examples","text":"fit_cumhist() function takes three parameters cumulative history computation (see also companion vignette): tau : normalized time constant units mean dominance phase duration. mixed_state : value used mixed/transition state phases, defaults 0.5. history_init : initial value cumulative history onset run. Defaults 0. Note although history_init accepts fixed values either single value used states vector two. contrast, fixed fitted values can used three parameters. possible function argument values single positive number tau single number within [0, 1] range mixed_state. case, value used directly cumulative history computation, default option mixed_state. NULL : single value fitted used participants runs. default tau. 'random' : independent tau fitted random cluster (participant, displays, etc.). random_effect argument must specified. '1|random' : values individual random cluster sampled fitted population distribution (pooled values). random_effect argument must specified. can specify custom priors cumulative history parameter via history_priors argument specifying mean standard deviation prior normal distribution. history_priors argument must named list, , e.g., history_priors = list(\"tau\"=c(1, 0.15)). fitted, can use history_tau() history_mixed_state()functions obtain posterior distribution summary parameter.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"distribution-family","dir":"Articles","previous_headings":"","what":"Distribution family","title":"Usage examples","text":"fit_cumhist currently supports three distributions: 'gamma', 'lognormal', 'normal'.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"gamma","dir":"Articles","previous_headings":"Distribution family","what":"Gamma","title":"Usage examples","text":"\\[Duration[] \\sim Gamma(shape[], rate[])\\] Gamma distribution independent linear models log link function fitted shape rate parameter. Priors intercepts parameters \\(\\alpha ~ Normal(log(3), 5)\\).","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"log-normal","dir":"Articles","previous_headings":"Distribution family","what":"Log-normal","title":"Usage examples","text":"\\[Duration[] \\sim LogNormal(\\mu[], \\sigma)\\] \\(\\mu\\) parameter computed via linear model log link function. Priors intercept \\(\\alpha ~ Normal(log(3), 5)\\). Prior \\(\\sigma\\) \\(\\sigma \\sim Exponential(1)\\).","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"normal","dir":"Articles","previous_headings":"Distribution family","what":"Normal","title":"Usage examples","text":"\\[Duration[] \\sim Normal(\\mu[], \\sigma)\\] \\(\\mu\\) parameter computed via linear model. Priors intercept \\(\\alpha ~ Normal(3, 5)\\). Prior \\(\\sigma\\) \\(\\sigma \\sim Exponential(1)\\).","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"model-comparison","dir":"Articles","previous_headings":"","what":"Model comparison","title":"Usage examples","text":"Models fits can compared via information criteria. Specifically, log likelihood stored log_lik parameter can directly using loo::extract_log_lik() function (see package (@ loo?)) used compute either leave-one-cross-validation (via loo() convenience function) WAIC (via waic()). information criteria can used model comparison way Akaike (AIC), Bayesian (BIC), deviance (DIC) information criteria. latter can also computed log likelihood, however, WAIC LOOCV preferred multi-level models, see (Vehtari, Gelman, Gabry 2017). model comparison can performed via loo::loo_compare() function loo package.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/usage-examples.html","id":"computing-and-using-cumulative-history","dir":"Articles","previous_headings":"","what":"Computing and using cumulative history","title":"Usage examples","text":"interested cumulative history , can extract fitted object via extract_history() function Alternatively, can skip fitting compute history directly using predefined values via compute_history().","code":"H <- extract_history(gam_fit) df <- compute_history(br_singleblock,                       state=\"State\",                       duration=\"Duration\",                        tau=1,                       mixed_state=0.5,                       history_init=0)"},{"path":[]},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/writing-stan-code.html","id":"stan-model","dir":"Articles","previous_headings":"","what":"Stan model","title":"Writing Stan code","text":"complete Stan code model log-normal distribution multiple runs single experimental session single participant. history time-constant tau fitted, whereas constants used cumulative history parameters.","code":"data{     // --- Complete time-series ---     int<lower=1> rowsN;     // Number of rows in the COMPLETE multi-timeseries table including mixed phase.     real duration[rowsN];   // Duration of a dominance/transition phase     int istate[rowsN];      // Index of a dominance istate, 1 and 2 code for two competing clear states, 3 - transition/mixed.     int is_used[rowsN];     // Whether history value must used to predict duration or ignored                             // (mixed phases, warm-up period, last, etc.)     int run_start[rowsN];   // 1 marks a beginning of the new time-series (run/block/etc.)     real session_tmean[rowsN]; // Mean dominance phase duration for both CLEAR percepts. Used to scale time-constant.          // --- A shorter clear-states only time-series ---     int clearN;                  // Number of rows in the clear-states only time-series     real clear_duration[clearN]; // Duration for clear percepts only.          // --- Cumulative history parameters     real<lower=0, upper=1> history_starting_values[2]; // Starting values for cumulative history at the beginning of the run     real<lower=0, upper=1> mixed_state;                // Mixed state signal strength } parameters {     real<lower=0> tau; // history time-constant          // linear model for mu     real a;     real bH;          // variance     real<lower=0> sigma; } transformed parameters{     vector[clearN] mu; // vector of computed mu for each clear percept        {         // temporary variables         real current_history[2]; // current computed history         real tau_H;              // tau in the units of time         real dH;                 // computed history difference         int iC = 1;              // Index of clear percepts used for fitting          // matrix with signal levels         matrix[2, 3] level = [[1, 0, mixed_state],                                [0, 1, mixed_state]];          for(iT in 1:rowsN){             // new time-series, recompute absolute tau and reset history state             if (run_start[iT]){                 // reset history                 current_history = history_starting_values;                  // Recompute tau in units of time.                  // This is relevant only for multiple sessions / participants.                 // However, we left this code for generality.                 tau_H = session_tmean[iT] * tau;             }              // for valid percepts, we use history to compute mu             if (is_used[iT] == 1){                 // history difference                 dH = current_history[3-istate[iT]] - current_history[istate[iT]];                  // linear model for mu                 mu[iC] = a + bH * dH;                 iC += 1;             }              // computing history for the NEXT episode             // see vignette on cumulative history             for(iState in 1:2){                 current_history[iState] = level[iState, istate[iT]] +                    (current_history[iState] - level[iState, istate[iT]]) * exp(-duration[iT] / tau_H);             }         }     } } model{   // sampling individual parameters   tau ~ lognormal(log(1), 0.75);   a ~ normal(log(3), 5);   bH ~ normal(0, 1);   sigma ~ exponential(1);      // sampling data using computed mu and sampled sigma   clear_duration ~ lognormal(exp(mu), sigma); }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/writing-stan-code.html","id":"data-preparation","dir":"Articles","previous_headings":"","what":"Data preparation","title":"Writing Stan code","text":"data section defines model inputs. Hopefully, comments make understanding fairly straightforward. However, several features although needed limited single session / single session make easier generalized code complicated cases. example, dominance phases used fitting. Specifically, mixed perception phases, first dominance phase percept (enough time form reliably history) last dominance phase (curtailed end block) excluded. Valid dominance phases marked is_used vector. total number stored clearN variable actual dominance durations clear_duration. latter strictly necessary allows us avoid loop vectorize sampling statement clear_duration ~ lognormal(exp(mu), sigma);. addition, session_tmean vector rather scalar. necessary single session example opted use better generalize complicated cases. bistability package provides service function preprocess_data() simplifies process preparing data. However, need perform last step, forming list inputs Stan sampling, .","code":"# function that checks data for internal consistency and returns a preprocessed table df <- bistablehistory::preprocess_data(br_single_subject,                                         state=\"State\",                                        duration=\"Duration\",                                        run=\"Block\")  # data for Stan model stan_data <- list(   # complete time-series   rowsN = nrow(df),   duration = df$duration,   istate = df$istate,   is_used = df$is_used,   run_start = df$run_start,   session_tmean = df$session_tmean,      # only valid clear percepts   clearN = sum(df$is_used),   clear_duration = df$duration[df$is_used == 1],      # history parameters, all fixed to default values   history_starting_values = c(0, 0),   mixed_state = 0.5 )"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/articles/writing-stan-code.html","id":"using-the-model","dir":"Articles","previous_headings":"","what":"Using the model","title":"Writing Stan code","text":"can use model either rstan cmdstanr packages. example using cmdstanr, assuming model file called example.stan.","code":"# compile the model model <- cmdstanr::cmdstan_model(\"example.stan\")  # sample model fit <- model$sample(data=stan_data, chains=1)  # extract posterior samples for tau parameter tau <- fit$draws(variables = \"tau\")"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Alexander Pastukhov. Author, maintainer.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pastukhov (2022). bistablehistory: Cumulative History Analysis Bistable Perception Time Series. https://github.com/alexander-pastukhov/bistablehistory, https://alexander-pastukhov.github.io/bistablehistory.","code":"@Manual{,   title = {bistablehistory: Cumulative History Analysis for Bistable Perception Time Series},   author = {Alexander Pastukhov},   year = {2022},   note = {https://github.com/alexander-pastukhov/bistablehistory, https://alexander-pastukhov.github.io/bistablehistory}, }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/index.html","id":"cumulative-history-analysis-for-bistable-perception-time-series","dir":"","previous_headings":"","what":"Cumulative History Analysis for Bistable Perception Time Series","title":"Cumulative History Analysis for Bistable Perception Time Series","text":"package compute cumulative history time-series perceptual dominance bistable displays. Estimates cumulative history, estimate accumulating adaptation/prediction error dominant percept, time-series continuously viewed bistable perceptual rivalry displays. Computes cumulative history via homogeneous first order differential process. .e., assumes exponential growth/decay history function time perceptually dominant state. Supports Gamma, log normal, normal distribution families. details rationale please refer (Pastukhov & Braun, 2011).","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Cumulative History Analysis for Bistable Perception Time Series","text":"current stable version use master branch development version. install please use","code":"install.packages(\"bistablehistory\") library(\"devtools\") install_github(\"alexander-pastukhov/bistablehistory\", dependencies = TRUE)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/index.html","id":"note","dir":"","previous_headings":"Installation","what":"Note","title":"Cumulative History Analysis for Bistable Perception Time Series","text":"package uses Stan, “state---art platform statistical modeling high-performance statistical computation”. Therefore, depends package rstantools, turn depends rstan package, uses V8 JavaScript library, V8 R package. Therefore, need install V8 JavaScript library system, recommended also install V8 R package beforehand. detailed instructions, please see https://github.com/jeroen/v8. also need R package curl, depends libcurl-* various operating systems. Please see documentation https://cran.r-project.org/package=curl.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Cumulative History Analysis for Bistable Perception Time Series","text":"main function fit_cumhist takes data frame time-series first argument. Minimally, need specify state — string column name encodes perceptually dominant state — either duration (column name duration individual dominance phases) onset (column name onset times individual dominance phases). Thus, simplest case single subject single run/block measurement defaults (gamma distribution, fitted cumulative history time constant fixed mixed state value history mixing proportion) call , equivalently Now can look fitted value history time constant via main effect history parameters gamma distribution details please see vignettes package usage (Usage examples Cumulative history) example writing Stan code directly (Writing Stan code).","code":"library(bistablehistory) data(br_singleblock) gamma_fit <- fit_cumhist(br_singleblock,                          state = \"State\",                          duration = \"Duration\") library(bistablehistory) data(br_singleblock) gamma_fit <- fit_cumhist(br_singleblock,                          state = \"State\",                          onset = \"Time\") history_tau(gamma_fit) coef(gamma_fit)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://alexander-pastukhov.github.io/bistablehistory/paper.html","id":null,"dir":"","previous_headings":"","what":"Summary","title":"Summary","text":"perception subject process adaptation changes operating properties [@Clifford2007]. process manifests plethora perceptual illusions -called aftereffects. also plays important role perception multistable stimuli, Necker cube (Fig. 1A). compatible several, typically two, comparably likely perceptual interpretations. case Necker cube, one can perceive “upwards” “downwards”, continuous viewing perception switches alternatives (Fig. 1B). Figure 1. Perception Necker cube stimulus. ) Necker cube. B) Schematic time series perceptual alternations. C) Example distribution perceptual dominance phases’ duration fitting Gamma distribution. Typically, time series multistable stimuli fitted using Gamma distribution (Fig. 1C). assumes individual dominance phase durations exchangeable, .e., order drawn unimportant. However, ignores effect prior perception adaptation [@VanEe2009] makes individual dominance phases serially dependent prior ones, violating assumptions independent identically distributed samples. words, dominance phase drawn specific distribution, whose parameters also determined prior perceptual history. bistablehistory package solves problem accounting slow accumulation process via homogeneous first-order process [@PastukhovBraun2011], providing tools fitting time series using various distributions. also allows fitting accounting additional random fixed factors. addition, provides tool extracting estimated accumulated adaptation computing directly usage. package aims streamline time series analysis perceptual multistability experiments continuous perception general. package built using Stan probabilistic programming language [@carpenter2017stan]. Thus, provides posterior distributions, ability compare models via information criteria [@loo], etc. addition, package provides Stan code performing estimation example explains implement custom Stan model relies . source code bistablehistory archived Zenodo linked DOI: [@zenodo]","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/paper.html","id":"statement-of-need","dir":"","previous_headings":"","what":"Statement of Need","title":"Summary","text":"Analysis time series psychophysical experiments, particularly multistable perception, frequently requires taking account slow accumulation adaptation. R extensive toolset working time-series, e.g., see cran.r-project.org/web/views/TimeSeries.html, using frequentist [@forecast] Bayesian [@varstan] approaches. purpose bistablehistory package extend existing tools incorporating fitting cumulative history via homogeneous first-order process, accurate [@PastukhovBraun2011] commonly used approximation via autocorrelation coefficient [@VanEe2009]. package simplifies computing cumulative history use directly part statistical (generalized) linear model fitted package function.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/paper.html","id":"cumulative-history-computation","dir":"","previous_headings":"","what":"Cumulative history computation","title":"Summary","text":"cumulative history perceptual state computed via homogeneous first-order process (details first order linear differential equations, please refer chapter 2 @Wilson1999): $$\\tag{1}\\frac{dh_i}{dt} = \\frac{1}{\\tau} (-h_i + S_i(t))$$ τ time constant, hi cumulative history Si(t) current signal level ith perceptual state, $$\\tag{2} S(t) = \\begin{cases}   1 & \\text{state $$ dominant}\\\\   0 & \\text{state $$ suppessed}\\\\   S_{mixed} & \\text{mixed/transition phase $0 ≥ S_{mixed} ≥1 $} \\end{cases}$$ Smixed corresponds mixed_state parameter can either specified (fit_cumhist() function uses default 0.5) fitted. general solution equation (see Theorem 1 @Wilson1999, chapter 2, page 15) $$\\tag{3}h_i(t) = e^{-t/\\tau} + \\frac{1}{\\tau} \\int_{0}^{t} e^{-(t'-t)/\\tau} S(t') dt'$$ chosen satisfy initial condition. Assuming constant signal S, obtain hi(t) = Ae−t/τ + Si ⋅ (1−e−t/τ) cumulative history, interested hi(t+Δt): change following dominance phase starts time t, ends time t + Δt, constant signal strength Si. Assuming dominance phase starts t = 0 substituting equation 4, hi(0) = . words, constant equal cumulative history state dominance phase onset , therefore, relative signal strength dominance phase determined difference signal strength initial cumulative history value: Si − hi(0). Thus hi(Δt) = hi(0) + (S−hi(0)) ⋅ (1−e−Δt/τ) hi(Δt) = S + (hi(0)−S) ⋅ e−Δt/τ figure shows accumulation time three different initial values (h(0)), signal strength (S), time constants (tau). Note package allows either specify fit time constant (argument tau fit_cumhist() function) initial history value block (history_init argument). Figure 2. Cumulative history different initial conditions, signal strength, time constants. bistable case, two history states, one perceptual state. Therefore, compute history difference cumulative histories: Δh(t,τ) = hsuppressed(t,τ) − hdominant(t,τ) hdominant hsuppressed history states currently dominant suppressed states, respectively. E.g., left eye dominates following phase, hdominant = hleft hsuppressed = hright vice versa.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/paper.html","id":"usage-and-features","dir":"","previous_headings":"","what":"Usage and Features","title":"Summary","text":"main function fit_cumhist() takes data frame time-series first argument. addition, need specify name column codes perceptual state (state argument) column holds either dominance phase duration (duration) onset (onset). code simplest case scenario, fitting data using Gamma distribution (default family) single run single participant. default, function fits time constant τ slowly accumulating adaptation uses default values parameters influence history computation. Alternatively, one can specify onset individual dominance phases compute duration. Utility functions simplify extracting information fitted parameters. example, one can look fitted value history time constant using history_tau() main effect history parameters gamma distribution via extract estimate perceptual history / adaptation using extract_history() function compute expected duration dominance phase via predict() package extends analysis multiple experimental runs (via run argument specifies variable identifies individual runs), experimental session (via session argument) assumed different average dominance phase durations [@Suzuki2007], multiple participants (via random_effect argument). also allows incorporating fixed effects, although restricted continuous metric variables (see vignette reusing model code directly Stan overcoming limitations). example demonstrates analysis many observers (random_effect = \"Observer\") performed multiple runs (run = \"Block\") taking account dominance phase occurred (fixed_effects = \"LogTime\"). also uses custom prior tau parameter custom control parameters Stan sampler. Please refer “Usage Examples” vignette details settings. Models fits can compared via information criteria. Specifically, log-likelihood stored log_lik parameter can directly using loo::extract_log_lik() function (see package [@@loo]) used compute either leave-one-cross-validation (via loo() convenience function) WAIC (via waic()). information criteria can used model comparison way Akaike (AIC), Bayesian (BIC), deviance (DIC) information criteria. latter can also computed log-likelihood, WAIC LOOCV recommended multi-level models, see [@loo]. model comparison can performed via loo::loo_compare() function loo package.","code":"library(bistablehistory) data(br_singleblock) gamma_fit <- fit_cumhist(br_singleblock,                         state=\"State\",                         duration=\"Duration\",                         refresh=0) gamma_fit <- fit_cumhist(br_singleblock,                         state=\"State\",                         onset=\"Time\") history_tau(gamma_fit) historyef(gamma_fit) H <- extract_history(gam_fit) br_singleblock$Predicted <- predict(gam_fit) library(bistablehistory) library(tidyverse)  data(kde) kde$LogTime <- log(kde$Time) kde_fit <- fit_cumhist(kde,                        state = \"State\",                        duration = \"Duration\",                        random_effect = \"Observer\",                        fixed_effects = \"LogTime\",                        run = \"Block\",                        tau = \"1|random\",                        history_priors = list(\"tau\"=c(log(0.5), 0.3)),                        chains = 4,                        control = list(max_treedepth = 15,                                       adapt_delta = 0.99)) library(loo) fit1 <- fit_cumhist(br_singleblock,                     state=\"State\",                     onset=\"Time\")                          br_singleblock$LogTime <- log(br_singleblock$Time) fit2 <- fit_cumhist(br_singleblock,                     state=\"State\",                     onset=\"Time\",                     fixed_effects = \"LogTime\")                      loo::loo_compare(list(\"null\" = loo(fit1),                       \"+logTime\" = loo(fit2)))"},{"path":[]},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/bayes_R2.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes R-squared using Bayesian R-squared approach. — bayes_R2","title":"Computes R-squared using Bayesian R-squared approach. — bayes_R2","text":"detail refer : Andrew Gelman, Ben Goodrich, Jonah Gabry, Aki Vehtari (2018). R-squared Bayesian regression models. American Statistician doi: 10.1080/00031305.2018.1549100  https://avehtari.github.io/bayes_R2/bayes_R2.html","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/bayes_R2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes R-squared using Bayesian R-squared approach. — bayes_R2","text":"","code":"# S3 method for cumhist bayes_R2(object, summary = TRUE, probs = c(0.055, 0.945), ...)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/bayes_R2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes R-squared using Bayesian R-squared approach. — bayes_R2","text":"object object class cumhist summary Whether summary statistics returned instead raw sample values. Defaults TRUE probs percentiles used compute summary, defaults 89% credible interval. ... Unused.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/bayes_R2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes R-squared using Bayesian R-squared approach. — bayes_R2","text":"vector values data.frame summary","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/bayes_R2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computes R-squared using Bayesian R-squared approach. — bayes_R2","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock, state = \"State\", duration = \"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0.001 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 10 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.239 seconds (Warm-up) #> Chain 1:                5.527 seconds (Sampling) #> Chain 1:                10.766 seconds (Total) #> Chain 1:  #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> http://mc-stan.org/misc/warnings.html#bulk-ess bayes_R2(br_fit) #> # A tibble: 1 x 3 #>      R2 `5.5%` `94.5%` #>   <dbl>  <dbl>   <dbl> #> 1 0.336  0.197   0.454 # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/bistablehistory-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Cumulative History Analysis for Bistable Perception Time Series — bistablehistory-package","title":"Cumulative History Analysis for Bistable Perception Time Series — bistablehistory-package","text":"Estimates cumulative history time-series continuously viewed bistable perceptual rivalry displays. Computes cumulative history via homogeneous first order differential process. .e., assumes exponential growth/decay history function time perceptually dominant state, Pastukhov & Braun (2011) doi: 10.1167/11.10.12 . Supports Gamma, log normal, normal distribution families. Provides method compute history directly example using computation custom Stan code.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/bistablehistory-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cumulative History Analysis for Bistable Perception Time Series — bistablehistory-package","text":"Stan Development Team (2020). RStan: R interface Stan. R package version 2.21.2. https://mc-stan.org","code":""},{"path":[]},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br.html","id":null,"dir":"Reference","previous_headings":"","what":"Binocular rivalry data — br","title":"Binocular rivalry data — br","text":"Dataset binocular rivalry eight participants.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Binocular rivalry data — br","text":"","code":"br"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Binocular rivalry data — br","text":"data frame 3769 rows 6 variables: Observer Participant ID. Display Display, rows contain \"BR\" Block Run / block index. Time Time relative run onset seconds State Factor levels \"Left\", \"Right\" (clear states), \"Mixed\" Duration Duration dominance phase seconds. Note duration last dominance phase curtailed , therefore, set zero.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Binocular rivalry data — br","text":"doi: 10.1167/11.10.12","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br_contrast.html","id":null,"dir":"Reference","previous_headings":"","what":"Binocular rivalry, variable contrast — br_contrast","title":"Binocular rivalry, variable contrast — br_contrast","text":"Dataset binocular rivalry variable equal contrast six participants.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br_contrast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Binocular rivalry, variable contrast — br_contrast","text":"","code":"br_contrast"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br_contrast.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Binocular rivalry, variable contrast — br_contrast","text":"data frame 4616 rows 6 variables: Observer Participant ID. Block Run / block index. Contrast Contrast scale 0 1. Time Time relative run onset seconds State Factor levels \"Left\", \"Right\" (clear states), \"Mixed\" Duration Duration dominance phase seconds. Note duration last dominance phase curtailed , therefore, set zero.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br_singleblock.html","id":null,"dir":"Reference","previous_headings":"","what":"Single run for binocular rivalry stimulus — br_singleblock","title":"Single run for binocular rivalry stimulus — br_singleblock","text":"single subject / single run dataset binocular rivalry.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br_singleblock.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single run for binocular rivalry stimulus — br_singleblock","text":"","code":"br_singleblock"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br_singleblock.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Single run for binocular rivalry stimulus — br_singleblock","text":"data frame 76 rows 6 variables: Observer Participant ID, rows contain \"ap\" Group Display, rows contain \"BR\" Block Run / block index, rows contain 1 Time Time relative run onset seconds State Index perceptually dominant state, 1, 2 - clear perceptual state, 3 mixed / transition phase Duration Duration dominance phase seconds. Note duration last dominance phase curtailed , therefore, set zero.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br_singleblock.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Single run for binocular rivalry stimulus — br_singleblock","text":"doi: 10.1167/11.10.12","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br_single_subject.html","id":null,"dir":"Reference","previous_headings":"","what":"Single experimental session for binocular rivalry stimulus — br_single_subject","title":"Single experimental session for binocular rivalry stimulus — br_single_subject","text":"single subject / multiple runs dataset binocular rivalry.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br_single_subject.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single experimental session for binocular rivalry stimulus — br_single_subject","text":"","code":"br_single_subject"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br_single_subject.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Single experimental session for binocular rivalry stimulus — br_single_subject","text":"data frame 76 rows 6 variables: Observer Participant ID, rows contain \"ap\" Display Display, rows contain \"BR\" Block Run / block index Time Time relative run onset seconds State Index perceptually dominant state, 1, 2 - clear perceptual state, 3 mixed / transition phase Duration Duration dominance phase seconds. Note duration last dominance phase curtailed , therefore, set zero.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/br_single_subject.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Single experimental session for binocular rivalry stimulus — br_single_subject","text":"doi: 10.1167/11.10.12","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/check_fixed_history_parameter.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluates values for a fixed history parameter — check_fixed_history_parameter","title":"Evaluates values for a fixed history parameter — check_fixed_history_parameter","text":"Expects either single value within valid range randomN values.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/check_fixed_history_parameter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluates values for a fixed history parameter — check_fixed_history_parameter","text":"","code":"check_fixed_history_parameter(param_name, param_value, randomN, upperLimit)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/check_fixed_history_parameter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluates values for a fixed history parameter — check_fixed_history_parameter","text":"param_name Name parameter. param_value single value randomN numeric values. randomN Number levels random variable. upperLimit Upper limit valid param_value.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/check_fixed_history_parameter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluates values for a fixed history parameter — check_fixed_history_parameter","text":"numeric vector randomN long.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/check_fixed_history_parameter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluates values for a fixed history parameter — check_fixed_history_parameter","text":"","code":"check_fixed_history_parameter(\"tau\", 1, 10, Inf) #>  [1] 1 1 1 1 1 1 1 1 1 1"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/check_normal_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Checks for validity of values for use as normal distribution parameters. — check_normal_prior","title":"Checks for validity of values for use as normal distribution parameters. — check_normal_prior","text":"pair numeric values, second value non-zero. Stops execution error.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/check_normal_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Checks for validity of values for use as normal distribution parameters. — check_normal_prior","text":"","code":"check_normal_prior(values, parameter)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/check_normal_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Checks for validity of values for use as normal distribution parameters. — check_normal_prior","text":"values Parameters normal distribution. parameter Name parameter prior defined.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/check_normal_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Checks for validity of values for use as normal distribution parameters. — check_normal_prior","text":"Logical TRUE, none tests fail","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/check_normal_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Checks for validity of values for use as normal distribution parameters. — check_normal_prior","text":"","code":"check_normal_prior(c(0, 1), \"tau\") #> [1] TRUE"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/coef.cumhist.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Model Coefficients — coef.cumhist","title":"Extract Model Coefficients — coef.cumhist","text":"Extracts models population-level coefficients history-specific terms fixed-effect terms every modeled distribution parameter.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/coef.cumhist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Model Coefficients — coef.cumhist","text":"","code":"# S3 method for cumhist coef(object, summary = TRUE, probs = c(0.055, 0.945), ...)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/coef.cumhist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Model Coefficients — coef.cumhist","text":"object object class cumhist summary Whether summary statistics returned instead raw sample values. Defaults TRUE probs percentiles used compute summary, defaults 89% credible interval. ... Unused.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/coef.cumhist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Model Coefficients — coef.cumhist","text":"data.frame values summary","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/coef.cumhist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Model Coefficients — coef.cumhist","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock,                       state = \"State\",                       duration = \"Duration\",                       fixed_effects = \"Time\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 72.871 seconds (Warm-up) #> Chain 1:                45.618 seconds (Sampling) #> Chain 1:                118.489 seconds (Total) #> Chain 1:  #> Warning: There were 20 transitions after warmup that exceeded the maximum treedepth. Increase max_treedepth above 10. See #> http://mc-stan.org/misc/warnings.html#maximum-treedepth-exceeded #> Warning: Examine the pairs() plot to diagnose sampling problems #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> http://mc-stan.org/misc/warnings.html#tail-ess coef(br_fit) #> # A tibble: 4 x 5 #>   DistributionParameter Term    Estimate    `5.5%`   `94.5%` #>   <fct>                 <chr>      <dbl>     <dbl>     <dbl> #> 1 shape                 History  1.29     0.414     2.12     #> 2 shape                 Time    -0.00417 -0.00741  -0.000870 #> 3 scale                 History -0.138   -1.16      0.853    #> 4 scale                 Time     0.00445  0.000884  0.00771  # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/compute_history.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes cumulative history for the time-series — compute_history","title":"Computes cumulative history for the time-series — compute_history","text":"Computes cumulative history state time-series.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/compute_history.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes cumulative history for the time-series — compute_history","text":"","code":"compute_history(   data,   state,   duration = NULL,   onset = NULL,   random_effect = NULL,   session = NULL,   run = NULL,   tau = 1,   mixed_state = 0.5,   history_init = 0 )"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/compute_history.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes cumulative history for the time-series — compute_history","text":"data table time-series. state String, name column specifies perceptual state. column type factor two three levels (third level assumed correspond transition/mixed phase) convertible two level factor (impossible infer identity transition/ mixed phase). duration String, name column duration individual perceptual dominance phases. Optional, can specify onset instead. onset String, name column onsets perceptual dominance states. Optional, used compute duration dominance phases, provided explicitly via duration parameter. random_effect String, name column identifies random effect, e.g. individual participants, stimuli single participant, etc. omitted, random effect assumed. specified one level (participant, stimulus, etc.), used hierarchical model. session String, name column identifies unique experimental session mean dominance phase duration computed (see norm_tau parameter). Code assumes session IDs different within participant can . omitted, single mean dominance duration based entire time series used. run String, name column identifies unique runs/blocks. omitted, data assumed belong single time series. Code assumes run IDs different within experimental session can session. E.g. session , runs 1, 2, 3.. session B, runs 1, 2, 3 session , runs 1, 2, 1. tau Time constant exponential growth/decay normalized mean duration clear percepts within session. Can 1) single positive number (>0) used participants runs, 2) NULL (default) -  single value fitted participants runs, 3) \"random\" - independent tau fitted random cluster, 4) \"1|random\"- tau random cluster sampled population distribution, .e., pooled parameter values via multilevel model. mixed_state Specifies activation level transition/mixed phases (state #3, see state). Either single number (range 0..1) used fixed level vector two numbers c(mu, kappa) specifies, correspondingly, mean (range 0..1) precision (>0) beta proportion distribution, sampled . Defaults fixed value 0.5. history_init Initial value cumulative history computation. Either numeric scalar 0..1 range vector two numbers 0..1 range. latter case, two histories start different levels.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/compute_history.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes cumulative history for the time-series — compute_history","text":"matrix nrow(data) × 2 computed history values","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/compute_history.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computes cumulative history for the time-series — compute_history","text":"","code":"df <- compute_history(br_singleblock, state = \"State\",                       duration = \"Duration\", tau = 1,                       mixed_state = 0.5, history_init = 0) #> Warning: Unknown or uninitialised column: `State`."},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/cumhist-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Class cumhist. — cumhist-class","title":"Class cumhist. — cumhist-class","text":"Cumulative history model fitted time-series data.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/cumhist-class.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Class cumhist. — cumhist-class","text":"See methods(class = \"cumhist\") overview available methods.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/cumhist-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Class cumhist. — cumhist-class","text":"family string distribution family. data list preprocessed data. stanfit stanfit object.","code":""},{"path":[]},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/evaluate_history_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluates validity of initial history values. — evaluate_history_init","title":"Evaluates validity of initial history values. — evaluate_history_init","text":"Checks number range values. scalar passed, uses value states.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/evaluate_history_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluates validity of initial history values. — evaluate_history_init","text":"","code":"evaluate_history_init(history_init)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/evaluate_history_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluates validity of initial history values. — evaluate_history_init","text":"history_init Either single value pair values within 0..1 range.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/evaluate_history_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluates validity of initial history values. — evaluate_history_init","text":"vector two values","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/evaluate_history_init.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluates validity of initial history values. — evaluate_history_init","text":"","code":"evaluate_history_init(0.5) #> [1] 0.5 0.5"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/evaluate_history_option.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluates whether and how to fit a cumulative history parameter. — evaluate_history_option","title":"Evaluates whether and how to fit a cumulative history parameter. — evaluate_history_option","text":"Evaluation based param_value. single positive number (>0) used participants runs. NULL (default) -  single value fitted participants runs, also applied randomN == 1. \"random\" - independent value fitted random cluster. \"1|random\"- value random cluster sampled population distribution, .e., pooled parameter values via multilevel model.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/evaluate_history_option.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluates whether and how to fit a cumulative history parameter. — evaluate_history_option","text":"","code":"evaluate_history_option(param_name, param_value, randomN, upperLimit)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/evaluate_history_option.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluates whether and how to fit a cumulative history parameter. — evaluate_history_option","text":"param_name Name parameter. param_value Value fit_cumhist function call. randomN Number levels random variable. upperLimit Upper limit valid param_value.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/evaluate_history_option.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluates whether and how to fit a cumulative history parameter. — evaluate_history_option","text":"list <param_name>_option fixed_<param_name>.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/evaluate_history_option.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluates whether and how to fit a cumulative history parameter. — evaluate_history_option","text":"","code":"evaluate_history_option(\"tau\", 1, 1, Inf) #> $tau_option #> [1] 1 #>  #> $fixed_tau #> [1] 1 #>  #> $tau_mu_size #> [1] 0 #>  #> $tau_sigma_size #> [1] 0 #>  #> $tau_rnd_size #> [1] 0 #>"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_history.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes history for a fitted model — extract_history","title":"Computes history for a fitted model — extract_history","text":"Computes history fitted model, uses mean values history parameter. Uses values random cluster, \"random\" \"1|random\" parametrisation used.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_history.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes history for a fitted model — extract_history","text":"","code":"extract_history(object)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_history.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes history for a fitted model — extract_history","text":"object object class cumhist","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_history.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes history for a fitted model — extract_history","text":"matrix cumulative history values state","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_history.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computes history for a fitted model — extract_history","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock, state = \"State\", duration = \"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.336 seconds (Warm-up) #> Chain 1:                6.376 seconds (Sampling) #> Chain 1:                11.712 seconds (Total) #> Chain 1:  extract_history(br_fit) #>               1         2 #>  [1,] 0.0000000 0.0000000 #>  [2,] 0.4390140 0.0000000 #>  [3,] 0.2248691 0.4877860 #>  [4,] 0.5380967 0.2906734 #>  [5,] 0.3174296 0.5815599 #>  [6,] 0.7953111 0.1743979 #>  [7,] 0.3124486 0.6756512 #>  [8,] 0.7606745 0.2351832 #>  [9,] 0.3425241 0.6556106 #> [10,] 0.6971363 0.3020045 #> [11,] 0.2551741 0.7445114 #> [12,] 0.8307942 0.1691343 #> [13,] 0.2594156 0.7405621 #> [14,] 0.7801470 0.2198464 #> [15,] 0.2913890 0.7086085 #> [16,] 0.7250378 0.2749612 #> [17,] 0.2627185 0.7372812 #> [18,] 0.6664120 0.3335879 #> [19,] 0.2853646 0.7146353 #> [20,] 0.6838478 0.3161522 #> [21,] 0.2679808 0.7320192 #> [22,] 0.7086870 0.2913130 #> [23,] 0.2374488 0.7625512 #> [24,] 0.7690038 0.2309962 #> [25,] 0.2844108 0.7155892 #> [26,] 0.7080128 0.2919872 #> [27,] 0.1810764 0.8189236 #> [28,] 0.7442910 0.2557090 #> [29,] 0.1742450 0.8257550 #> [30,] 0.8011855 0.1988145 #> [31,] 0.3171512 0.6828488 #> [32,] 0.7623114 0.2376886 #> [33,] 0.2905408 0.7094592 #> [34,] 0.7604234 0.2395766 #> [35,] 0.2025033 0.7974967 #> [36,] 0.6960490 0.3039510 #> [37,] 0.2398472 0.7601528 #> [38,] 0.8423258 0.1576742 #> [39,] 0.2335676 0.7664324 #> [40,] 0.7305756 0.2694244 #> [41,] 0.3867058 0.6132942 #> [42,] 0.6007470 0.3992530 #> [43,] 0.2384087 0.7615913 #> [44,] 0.8180186 0.1819814 #> [45,] 0.2934297 0.7065703 #> [46,] 0.8281533 0.1718467 #> [47,] 0.4382446 0.5617554 #> [48,] 0.5861040 0.4138960 #> [49,] 0.5577789 0.4422211 #> [50,] 0.3452206 0.6547794 #> [51,] 0.4303044 0.5696956 #> [52,] 0.6429215 0.3570785 #> [53,] 0.2545020 0.7454980 #> [54,] 0.6980295 0.3019705 #> [55,] 0.1771752 0.8228248 #> [56,] 0.8580717 0.1419283 #> [57,] 0.3141609 0.6858391 #> [58,] 0.4339795 0.5660205 #> [59,] 0.4701964 0.5298036 #> [60,] 0.6480572 0.3519428 #> [61,] 0.2296031 0.7703969 #> [62,] 0.6201626 0.3798374 #> [63,] 0.3027677 0.6972323 #> [64,] 0.7800778 0.2199222 #> [65,] 0.2114439 0.7885561 #> [66,] 0.6511456 0.3488544 #> [67,] 0.2991153 0.7008847 #> [68,] 0.7960441 0.2039559 #> [69,] 0.2098577 0.7901423 #> [70,] 0.8039039 0.1960961 #> [71,] 0.1436570 0.8563430 #> [72,] 0.8522902 0.1477098 #> [73,] 0.2764068 0.7235932 #> [74,] 0.7653310 0.2346690 #> [75,] 0.2143733 0.7856267 #> [76,] 0.8183867 0.1816133 # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_history_parameter.html","id":null,"dir":"Reference","previous_headings":"","what":"Extracts a history parameter as a matrix — extract_history_parameter","title":"Extracts a history parameter as a matrix — extract_history_parameter","text":"Extracts history parameter matrix samplesN rows randomN (found object$data$randomN) columns.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_history_parameter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extracts a history parameter as a matrix — extract_history_parameter","text":"","code":"extract_history_parameter(   object,   param_name,   samplesN = NULL,   link_function = NULL )"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_history_parameter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extracts a history parameter as a matrix — extract_history_parameter","text":"object cumhist object param_name String, name parameter samplesN Number samples, NULL computed rstan (cheaper ). link_function link function use (exp inv.logit) NULL identity.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_history_parameter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extracts a history parameter as a matrix — extract_history_parameter","text":"Matrix samplesN rows randomN (found object$data$randomN) columns","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_history_parameter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extracts a history parameter as a matrix — extract_history_parameter","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock, state=\"State\", duration=\"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.666 seconds (Warm-up) #> Chain 1:                5.98 seconds (Sampling) #> Chain 1:                11.646 seconds (Total) #> Chain 1:  #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> http://mc-stan.org/misc/warnings.html#bulk-ess extract_history_parameter(br_fit, \"tau\", link_function = exp) #>              [,1] #>    [1,] 1.0644964 #>    [2,] 0.9960436 #>    [3,] 0.8230219 #>    [4,] 0.8500291 #>    [5,] 1.0069592 #>    [6,] 0.8599762 #>    [7,] 1.2533189 #>    [8,] 0.9827817 #>    [9,] 1.1633156 #>   [10,] 1.0973242 #>   [11,] 0.9340265 #>   [12,] 1.0790112 #>   [13,] 0.7429560 #>   [14,] 0.8560725 #>   [15,] 1.0325606 #>   [16,] 1.2183829 #>   [17,] 0.9181795 #>   [18,] 1.1091461 #>   [19,] 1.0991949 #>   [20,] 1.0173111 #>   [21,] 0.9981620 #>   [22,] 1.0350662 #>   [23,] 0.9097209 #>   [24,] 0.8045297 #>   [25,] 0.9427634 #>   [26,] 0.8843964 #>   [27,] 1.0500814 #>   [28,] 1.0717855 #>   [29,] 1.1329443 #>   [30,] 1.0030932 #>   [31,] 0.8554808 #>   [32,] 0.7516949 #>   [33,] 1.1133038 #>   [34,] 0.9142508 #>   [35,] 1.0126275 #>   [36,] 1.1025390 #>   [37,] 1.0348263 #>   [38,] 0.8441943 #>   [39,] 0.9745436 #>   [40,] 0.9936197 #>   [41,] 0.8487997 #>   [42,] 0.9500149 #>   [43,] 0.9421060 #>   [44,] 1.1567039 #>   [45,] 0.9764469 #>   [46,] 1.1843307 #>   [47,] 0.9835433 #>   [48,] 0.7803060 #>   [49,] 1.1496373 #>   [50,] 0.9826454 #>   [51,] 0.8353241 #>   [52,] 1.0235374 #>   [53,] 1.0113475 #>   [54,] 1.0949637 #>   [55,] 1.2471327 #>   [56,] 1.0834217 #>   [57,] 0.9620807 #>   [58,] 1.0011907 #>   [59,] 0.9668201 #>   [60,] 1.1649485 #>   [61,] 0.8513478 #>   [62,] 0.9934275 #>   [63,] 1.0236907 #>   [64,] 1.0967518 #>   [65,] 0.9058658 #>   [66,] 1.1260260 #>   [67,] 1.1513270 #>   [68,] 1.0890223 #>   [69,] 0.9580381 #>   [70,] 0.9468607 #>   [71,] 1.1792605 #>   [72,] 0.8902806 #>   [73,] 0.8337704 #>   [74,] 1.1054506 #>   [75,] 1.1355083 #>   [76,] 0.9285187 #>   [77,] 1.1516658 #>   [78,] 1.1356716 #>   [79,] 0.8684089 #>   [80,] 1.1859882 #>   [81,] 0.9467046 #>   [82,] 0.9583658 #>   [83,] 1.0130980 #>   [84,] 1.1164523 #>   [85,] 0.8699467 #>   [86,] 0.9990963 #>   [87,] 1.1182319 #>   [88,] 0.7952341 #>   [89,] 0.9769800 #>   [90,] 0.9844688 #>   [91,] 0.8245958 #>   [92,] 1.0872056 #>   [93,] 0.7539712 #>   [94,] 0.8950974 #>   [95,] 0.7633295 #>   [96,] 0.9541209 #>   [97,] 1.0947522 #>   [98,] 1.2836274 #>   [99,] 0.8160129 #>  [100,] 0.9851578 #>  [101,] 0.9722595 #>  [102,] 1.0446334 #>  [103,] 0.9984763 #>  [104,] 0.9418748 #>  [105,] 0.8880803 #>  [106,] 0.8530196 #>  [107,] 1.1315249 #>  [108,] 0.9766202 #>  [109,] 1.0226429 #>  [110,] 0.9275043 #>  [111,] 0.9214337 #>  [112,] 0.9099607 #>  [113,] 1.0340367 #>  [114,] 1.0539994 #>  [115,] 0.7618016 #>  [116,] 0.9158671 #>  [117,] 0.7762242 #>  [118,] 0.9700616 #>  [119,] 0.9126060 #>  [120,] 0.9776330 #>  [121,] 1.0485191 #>  [122,] 1.0058762 #>  [123,] 0.9289261 #>  [124,] 0.9422056 #>  [125,] 0.9714289 #>  [126,] 1.1557023 #>  [127,] 0.8956034 #>  [128,] 1.0216114 #>  [129,] 0.8136244 #>  [130,] 0.9431378 #>  [131,] 0.9755966 #>  [132,] 1.2199630 #>  [133,] 0.8088533 #>  [134,] 0.8673136 #>  [135,] 0.8266101 #>  [136,] 0.8588465 #>  [137,] 1.1415861 #>  [138,] 0.7650248 #>  [139,] 0.8847474 #>  [140,] 0.8573863 #>  [141,] 1.1025521 #>  [142,] 0.7786324 #>  [143,] 0.9198140 #>  [144,] 1.1638929 #>  [145,] 0.9195984 #>  [146,] 0.8328266 #>  [147,] 1.0878080 #>  [148,] 0.9823897 #>  [149,] 1.0803510 #>  [150,] 0.8356064 #>  [151,] 0.9241223 #>  [152,] 0.9428769 #>  [153,] 1.0096576 #>  [154,] 0.9542590 #>  [155,] 0.8731789 #>  [156,] 0.8739028 #>  [157,] 0.9289878 #>  [158,] 1.1485479 #>  [159,] 0.8917264 #>  [160,] 0.8635636 #>  [161,] 1.1705939 #>  [162,] 1.0432903 #>  [163,] 1.1502798 #>  [164,] 0.8516790 #>  [165,] 1.0389536 #>  [166,] 1.0238172 #>  [167,] 0.9360604 #>  [168,] 1.0813434 #>  [169,] 0.8264520 #>  [170,] 0.9060209 #>  [171,] 0.9740551 #>  [172,] 1.2071280 #>  [173,] 0.8869579 #>  [174,] 0.8952473 #>  [175,] 1.0703719 #>  [176,] 0.9859153 #>  [177,] 0.8800780 #>  [178,] 0.8170354 #>  [179,] 0.7392583 #>  [180,] 0.9918889 #>  [181,] 1.3643428 #>  [182,] 1.1186670 #>  [183,] 1.0916920 #>  [184,] 0.7649281 #>  [185,] 0.9291941 #>  [186,] 0.7782021 #>  [187,] 0.8543643 #>  [188,] 0.9632669 #>  [189,] 1.0494223 #>  [190,] 0.8147305 #>  [191,] 1.0633419 #>  [192,] 1.0536475 #>  [193,] 1.0137288 #>  [194,] 0.8335696 #>  [195,] 0.8435674 #>  [196,] 1.0868848 #>  [197,] 0.9270063 #>  [198,] 1.0246200 #>  [199,] 0.8651446 #>  [200,] 0.9446560 #>  [201,] 0.9946831 #>  [202,] 1.2120100 #>  [203,] 0.8119596 #>  [204,] 1.4042295 #>  [205,] 0.8778305 #>  [206,] 1.0676841 #>  [207,] 0.9854594 #>  [208,] 0.8162944 #>  [209,] 1.0408275 #>  [210,] 1.0280329 #>  [211,] 0.8503689 #>  [212,] 0.9379891 #>  [213,] 1.3009080 #>  [214,] 0.9542243 #>  [215,] 0.9811914 #>  [216,] 1.1101650 #>  [217,] 0.9206168 #>  [218,] 0.7182010 #>  [219,] 0.8188293 #>  [220,] 0.9700987 #>  [221,] 0.8704067 #>  [222,] 0.8480782 #>  [223,] 0.8055231 #>  [224,] 0.8987296 #>  [225,] 1.2500228 #>  [226,] 0.8758267 #>  [227,] 0.9384572 #>  [228,] 0.9532942 #>  [229,] 0.9123850 #>  [230,] 1.1516294 #>  [231,] 0.8770495 #>  [232,] 1.1883289 #>  [233,] 1.1014744 #>  [234,] 1.0676788 #>  [235,] 1.2619573 #>  [236,] 0.7666006 #>  [237,] 0.7348492 #>  [238,] 0.9695952 #>  [239,] 0.7919957 #>  [240,] 1.0264675 #>  [241,] 0.9350116 #>  [242,] 0.9306518 #>  [243,] 1.1435175 #>  [244,] 1.2247848 #>  [245,] 1.1542359 #>  [246,] 0.9481316 #>  [247,] 0.7650470 #>  [248,] 0.7930653 #>  [249,] 0.8905161 #>  [250,] 1.0165685 #>  [251,] 0.9874286 #>  [252,] 0.9037953 #>  [253,] 1.0879866 #>  [254,] 0.9885428 #>  [255,] 0.9482439 #>  [256,] 1.0867165 #>  [257,] 0.9462783 #>  [258,] 0.9648485 #>  [259,] 1.0051250 #>  [260,] 1.2296803 #>  [261,] 0.9910454 #>  [262,] 0.8923384 #>  [263,] 1.1546554 #>  [264,] 1.2320298 #>  [265,] 1.0806848 #>  [266,] 0.9447362 #>  [267,] 1.0965378 #>  [268,] 1.1383253 #>  [269,] 0.9678125 #>  [270,] 1.1888224 #>  [271,] 0.9299785 #>  [272,] 0.8893411 #>  [273,] 0.9777944 #>  [274,] 1.1912424 #>  [275,] 0.7662472 #>  [276,] 0.8750370 #>  [277,] 0.8674487 #>  [278,] 0.8934471 #>  [279,] 1.1589874 #>  [280,] 0.8643381 #>  [281,] 1.0709254 #>  [282,] 1.0785410 #>  [283,] 1.1972913 #>  [284,] 1.0265247 #>  [285,] 0.7857863 #>  [286,] 0.9891501 #>  [287,] 1.1526235 #>  [288,] 1.2485208 #>  [289,] 0.8037958 #>  [290,] 1.0323631 #>  [291,] 0.7860092 #>  [292,] 1.0204177 #>  [293,] 0.8826771 #>  [294,] 0.7724837 #>  [295,] 0.7363722 #>  [296,] 0.9825250 #>  [297,] 1.0151776 #>  [298,] 1.0036801 #>  [299,] 0.9486908 #>  [300,] 0.9236656 #>  [301,] 1.0091828 #>  [302,] 0.9497575 #>  [303,] 1.1063321 #>  [304,] 0.9247874 #>  [305,] 1.0141559 #>  [306,] 1.0911475 #>  [307,] 1.1992003 #>  [308,] 0.7474278 #>  [309,] 0.9785369 #>  [310,] 0.8031919 #>  [311,] 0.9177063 #>  [312,] 1.2086591 #>  [313,] 1.3017202 #>  [314,] 1.0732590 #>  [315,] 0.7778946 #>  [316,] 1.1145625 #>  [317,] 1.2362490 #>  [318,] 1.0741602 #>  [319,] 1.2334812 #>  [320,] 0.7248766 #>  [321,] 1.0748259 #>  [322,] 0.8049957 #>  [323,] 1.1841354 #>  [324,] 1.0262682 #>  [325,] 0.9378966 #>  [326,] 0.9871178 #>  [327,] 1.0159766 #>  [328,] 1.0358164 #>  [329,] 0.9292950 #>  [330,] 1.0235185 #>  [331,] 0.7499460 #>  [332,] 0.8711979 #>  [333,] 0.8016313 #>  [334,] 1.0085429 #>  [335,] 0.9192662 #>  [336,] 1.0305212 #>  [337,] 1.1310341 #>  [338,] 0.9663516 #>  [339,] 0.9045115 #>  [340,] 0.8574126 #>  [341,] 1.1339388 #>  [342,] 0.8367180 #>  [343,] 0.7329975 #>  [344,] 0.9170199 #>  [345,] 0.9173196 #>  [346,] 0.7869458 #>  [347,] 0.9050986 #>  [348,] 0.7547299 #>  [349,] 1.0327615 #>  [350,] 0.9606654 #>  [351,] 0.8274406 #>  [352,] 1.0710950 #>  [353,] 0.9861769 #>  [354,] 1.0108115 #>  [355,] 0.9588047 #>  [356,] 1.0781401 #>  [357,] 1.0578124 #>  [358,] 0.9289031 #>  [359,] 0.8854609 #>  [360,] 0.7177209 #>  [361,] 0.9750122 #>  [362,] 1.0479767 #>  [363,] 1.0349706 #>  [364,] 0.9237908 #>  [365,] 0.9317550 #>  [366,] 0.9613342 #>  [367,] 0.9249542 #>  [368,] 0.9670758 #>  [369,] 0.9242933 #>  [370,] 0.9782864 #>  [371,] 1.0930859 #>  [372,] 0.8636122 #>  [373,] 1.0770298 #>  [374,] 1.1382066 #>  [375,] 0.9023302 #>  [376,] 1.1463226 #>  [377,] 1.0651701 #>  [378,] 1.0076542 #>  [379,] 1.1073257 #>  [380,] 1.1246642 #>  [381,] 0.9435688 #>  [382,] 0.7878384 #>  [383,] 0.8258944 #>  [384,] 0.9882795 #>  [385,] 0.9536485 #>  [386,] 1.1307461 #>  [387,] 1.0095845 #>  [388,] 0.9209415 #>  [389,] 1.1330704 #>  [390,] 1.1540527 #>  [391,] 1.0265581 #>  [392,] 0.8516159 #>  [393,] 0.9678774 #>  [394,] 0.9350538 #>  [395,] 0.9371868 #>  [396,] 1.0369329 #>  [397,] 0.9759114 #>  [398,] 0.8976366 #>  [399,] 1.2525408 #>  [400,] 0.7682241 #>  [401,] 0.9875067 #>  [402,] 1.0049732 #>  [403,] 0.7895771 #>  [404,] 1.0527124 #>  [405,] 1.1167821 #>  [406,] 0.7658424 #>  [407,] 1.1126774 #>  [408,] 0.7763765 #>  [409,] 1.0430265 #>  [410,] 1.0070526 #>  [411,] 1.1510101 #>  [412,] 0.9424039 #>  [413,] 0.8144382 #>  [414,] 1.0048647 #>  [415,] 0.8244123 #>  [416,] 1.1831651 #>  [417,] 0.7870858 #>  [418,] 0.8033039 #>  [419,] 1.1165342 #>  [420,] 1.0251405 #>  [421,] 1.1646322 #>  [422,] 0.9971288 #>  [423,] 0.8405719 #>  [424,] 0.9914756 #>  [425,] 0.8132438 #>  [426,] 1.1705882 #>  [427,] 1.0755073 #>  [428,] 1.3290954 #>  [429,] 0.9046366 #>  [430,] 0.7794996 #>  [431,] 0.8663054 #>  [432,] 1.1201367 #>  [433,] 1.2391268 #>  [434,] 0.8781362 #>  [435,] 0.8670868 #>  [436,] 1.0309563 #>  [437,] 0.9786251 #>  [438,] 1.0927044 #>  [439,] 0.9538393 #>  [440,] 0.9258300 #>  [441,] 0.9974645 #>  [442,] 0.8456301 #>  [443,] 1.0084775 #>  [444,] 0.9332716 #>  [445,] 1.0995818 #>  [446,] 0.7055367 #>  [447,] 0.7777109 #>  [448,] 0.7817665 #>  [449,] 1.0349222 #>  [450,] 1.0428352 #>  [451,] 1.0631685 #>  [452,] 0.8531252 #>  [453,] 1.1961137 #>  [454,] 0.8294552 #>  [455,] 0.9694766 #>  [456,] 1.0417644 #>  [457,] 0.8686346 #>  [458,] 0.7626943 #>  [459,] 1.1352822 #>  [460,] 0.8576598 #>  [461,] 0.9647736 #>  [462,] 1.1237151 #>  [463,] 0.7703935 #>  [464,] 1.0067198 #>  [465,] 1.0894116 #>  [466,] 1.0197013 #>  [467,] 1.1162130 #>  [468,] 0.9512640 #>  [469,] 1.1611685 #>  [470,] 0.7739124 #>  [471,] 0.9283914 #>  [472,] 0.9795492 #>  [473,] 1.2800450 #>  [474,] 0.7400073 #>  [475,] 1.0837466 #>  [476,] 1.0099246 #>  [477,] 0.9112756 #>  [478,] 1.2168647 #>  [479,] 1.0216680 #>  [480,] 1.0270679 #>  [481,] 0.9562060 #>  [482,] 1.0714244 #>  [483,] 1.4220592 #>  [484,] 0.9819019 #>  [485,] 0.9046139 #>  [486,] 0.9457210 #>  [487,] 0.9283934 #>  [488,] 1.0078369 #>  [489,] 1.2854844 #>  [490,] 0.8047569 #>  [491,] 0.8377491 #>  [492,] 0.8200450 #>  [493,] 0.8155119 #>  [494,] 1.0963944 #>  [495,] 1.3147280 #>  [496,] 0.9347550 #>  [497,] 1.0003714 #>  [498,] 1.1754415 #>  [499,] 1.3167478 #>  [500,] 1.2162964 #>  [501,] 1.2328234 #>  [502,] 1.0941001 #>  [503,] 0.9147443 #>  [504,] 0.8332372 #>  [505,] 0.8342597 #>  [506,] 0.8600063 #>  [507,] 1.0737886 #>  [508,] 0.9435953 #>  [509,] 0.9202688 #>  [510,] 1.1234409 #>  [511,] 1.1414850 #>  [512,] 0.8565144 #>  [513,] 0.9950971 #>  [514,] 1.2634001 #>  [515,] 0.9939462 #>  [516,] 0.8715971 #>  [517,] 0.9772980 #>  [518,] 1.1720930 #>  [519,] 1.1894715 #>  [520,] 1.0053353 #>  [521,] 0.8564155 #>  [522,] 1.0778612 #>  [523,] 1.0484153 #>  [524,] 1.0510051 #>  [525,] 1.1469912 #>  [526,] 1.1557150 #>  [527,] 1.0101390 #>  [528,] 0.8500522 #>  [529,] 1.1526077 #>  [530,] 0.8914982 #>  [531,] 1.1911156 #>  [532,] 0.8859553 #>  [533,] 0.6797687 #>  [534,] 1.3814133 #>  [535,] 0.7575560 #>  [536,] 1.0626446 #>  [537,] 0.9332493 #>  [538,] 0.8132537 #>  [539,] 0.8876322 #>  [540,] 1.1240035 #>  [541,] 1.1448090 #>  [542,] 0.9903687 #>  [543,] 0.7245736 #>  [544,] 0.9378330 #>  [545,] 0.9462916 #>  [546,] 0.9157446 #>  [547,] 1.1190801 #>  [548,] 0.9637636 #>  [549,] 0.8607720 #>  [550,] 1.1156533 #>  [551,] 0.9021372 #>  [552,] 1.1025628 #>  [553,] 1.1191214 #>  [554,] 0.7686797 #>  [555,] 1.0013189 #>  [556,] 1.0385301 #>  [557,] 1.0128885 #>  [558,] 0.8669667 #>  [559,] 0.8639220 #>  [560,] 0.9500617 #>  [561,] 0.9555696 #>  [562,] 1.1974159 #>  [563,] 0.9850605 #>  [564,] 1.0869866 #>  [565,] 0.7904638 #>  [566,] 0.9862868 #>  [567,] 0.9625965 #>  [568,] 0.9057442 #>  [569,] 0.8797552 #>  [570,] 0.8718212 #>  [571,] 1.0767672 #>  [572,] 0.9637598 #>  [573,] 0.9486572 #>  [574,] 1.0128412 #>  [575,] 0.9892642 #>  [576,] 0.9675013 #>  [577,] 1.0119144 #>  [578,] 0.8756446 #>  [579,] 0.9737250 #>  [580,] 1.3395609 #>  [581,] 1.0417943 #>  [582,] 0.9110374 #>  [583,] 1.2114058 #>  [584,] 1.1473021 #>  [585,] 1.1671210 #>  [586,] 0.8563270 #>  [587,] 0.9472644 #>  [588,] 0.9338995 #>  [589,] 1.0062240 #>  [590,] 0.8844981 #>  [591,] 1.2723778 #>  [592,] 1.0332096 #>  [593,] 0.9768724 #>  [594,] 0.8595884 #>  [595,] 0.8785922 #>  [596,] 0.9843690 #>  [597,] 0.9417086 #>  [598,] 0.9664546 #>  [599,] 0.9100384 #>  [600,] 0.8784775 #>  [601,] 0.8367823 #>  [602,] 0.8583464 #>  [603,] 0.8887963 #>  [604,] 1.1084178 #>  [605,] 0.9346394 #>  [606,] 1.0778110 #>  [607,] 1.2106262 #>  [608,] 1.0829542 #>  [609,] 0.9340218 #>  [610,] 0.7882597 #>  [611,] 0.9579363 #>  [612,] 0.9201514 #>  [613,] 0.9529735 #>  [614,] 1.0071793 #>  [615,] 1.1346783 #>  [616,] 0.8877876 #>  [617,] 0.8797161 #>  [618,] 0.9426895 #>  [619,] 0.9033455 #>  [620,] 0.8415231 #>  [621,] 0.9734729 #>  [622,] 0.9896746 #>  [623,] 0.9121836 #>  [624,] 1.1657436 #>  [625,] 1.0658448 #>  [626,] 0.9543476 #>  [627,] 0.9278676 #>  [628,] 0.8319251 #>  [629,] 1.0694705 #>  [630,] 1.1339951 #>  [631,] 0.8858814 #>  [632,] 0.9337372 #>  [633,] 1.0713848 #>  [634,] 0.9399761 #>  [635,] 1.1092291 #>  [636,] 0.9781418 #>  [637,] 0.8801138 #>  [638,] 0.7868170 #>  [639,] 1.1652170 #>  [640,] 1.1213615 #>  [641,] 0.9968469 #>  [642,] 1.0609677 #>  [643,] 1.0639649 #>  [644,] 0.9993383 #>  [645,] 0.7974377 #>  [646,] 0.9730071 #>  [647,] 0.8653758 #>  [648,] 0.7784178 #>  [649,] 0.9755292 #>  [650,] 1.0641685 #>  [651,] 1.1941307 #>  [652,] 1.2253388 #>  [653,] 0.9568750 #>  [654,] 1.0967669 #>  [655,] 0.9788519 #>  [656,] 0.7821466 #>  [657,] 1.0561330 #>  [658,] 1.2119085 #>  [659,] 0.7173837 #>  [660,] 1.0720524 #>  [661,] 0.8709622 #>  [662,] 0.7799197 #>  [663,] 0.9904431 #>  [664,] 1.0960772 #>  [665,] 0.7993931 #>  [666,] 0.7905612 #>  [667,] 1.0565267 #>  [668,] 1.1676958 #>  [669,] 0.9242393 #>  [670,] 0.9370541 #>  [671,] 0.8815185 #>  [672,] 0.9114511 #>  [673,] 0.8725962 #>  [674,] 0.8733600 #>  [675,] 1.0474633 #>  [676,] 1.1177692 #>  [677,] 0.7717983 #>  [678,] 1.0807877 #>  [679,] 0.8220763 #>  [680,] 0.9931054 #>  [681,] 0.8124361 #>  [682,] 0.7984894 #>  [683,] 1.1309783 #>  [684,] 1.0422433 #>  [685,] 1.1376934 #>  [686,] 0.8902348 #>  [687,] 1.0104682 #>  [688,] 0.9307173 #>  [689,] 1.1408495 #>  [690,] 0.9163101 #>  [691,] 0.9628954 #>  [692,] 1.0508868 #>  [693,] 1.0822675 #>  [694,] 0.9434722 #>  [695,] 1.0659331 #>  [696,] 0.9322564 #>  [697,] 1.0756962 #>  [698,] 1.4772438 #>  [699,] 0.9616350 #>  [700,] 0.8433620 #>  [701,] 1.0721619 #>  [702,] 0.9572289 #>  [703,] 1.1109488 #>  [704,] 1.0253017 #>  [705,] 1.0209441 #>  [706,] 1.1393045 #>  [707,] 0.9446106 #>  [708,] 0.8622058 #>  [709,] 1.1364490 #>  [710,] 1.0425507 #>  [711,] 1.0780414 #>  [712,] 1.1651444 #>  [713,] 1.0240463 #>  [714,] 0.9154325 #>  [715,] 0.8271892 #>  [716,] 0.8090642 #>  [717,] 0.9885725 #>  [718,] 1.0197084 #>  [719,] 1.0219151 #>  [720,] 1.0701485 #>  [721,] 1.0679014 #>  [722,] 0.8934435 #>  [723,] 0.9402385 #>  [724,] 1.1097054 #>  [725,] 1.1097400 #>  [726,] 0.8534073 #>  [727,] 1.0959995 #>  [728,] 0.7923450 #>  [729,] 0.9441592 #>  [730,] 0.8019843 #>  [731,] 0.9556923 #>  [732,] 0.7689038 #>  [733,] 0.8506250 #>  [734,] 0.8881846 #>  [735,] 1.1006493 #>  [736,] 1.1471113 #>  [737,] 1.1054019 #>  [738,] 1.1070216 #>  [739,] 0.8801733 #>  [740,] 1.0750278 #>  [741,] 1.0657105 #>  [742,] 0.8918011 #>  [743,] 0.7657938 #>  [744,] 0.8749249 #>  [745,] 1.1161069 #>  [746,] 0.9796143 #>  [747,] 0.9352828 #>  [748,] 1.0768345 #>  [749,] 1.1133624 #>  [750,] 0.9541606 #>  [751,] 0.9193258 #>  [752,] 0.8830779 #>  [753,] 1.0524498 #>  [754,] 1.4312877 #>  [755,] 1.1408295 #>  [756,] 0.7752101 #>  [757,] 1.0167069 #>  [758,] 1.0534016 #>  [759,] 0.7030489 #>  [760,] 0.8818757 #>  [761,] 0.9573647 #>  [762,] 0.8884515 #>  [763,] 0.9030808 #>  [764,] 0.8736986 #>  [765,] 0.9787062 #>  [766,] 0.8900988 #>  [767,] 1.0767873 #>  [768,] 0.8171701 #>  [769,] 0.9333081 #>  [770,] 1.0361401 #>  [771,] 0.9556175 #>  [772,] 0.9671898 #>  [773,] 0.8156145 #>  [774,] 0.9993928 #>  [775,] 0.9896495 #>  [776,] 1.0820051 #>  [777,] 0.7945853 #>  [778,] 0.9577153 #>  [779,] 0.9760221 #>  [780,] 1.2023250 #>  [781,] 0.9673740 #>  [782,] 0.8882379 #>  [783,] 1.2808789 #>  [784,] 1.0579261 #>  [785,] 0.9584766 #>  [786,] 0.9768863 #>  [787,] 0.9567960 #>  [788,] 1.3954797 #>  [789,] 0.9031585 #>  [790,] 1.1367593 #>  [791,] 0.7592126 #>  [792,] 1.1855529 #>  [793,] 1.1038407 #>  [794,] 0.9226300 #>  [795,] 0.9820851 #>  [796,] 0.8540621 #>  [797,] 1.1147299 #>  [798,] 1.2099607 #>  [799,] 1.2638991 #>  [800,] 0.9444427 #>  [801,] 0.8731020 #>  [802,] 0.8428490 #>  [803,] 0.9309619 #>  [804,] 0.8515938 #>  [805,] 1.1078930 #>  [806,] 0.9483237 #>  [807,] 1.3092476 #>  [808,] 0.9555188 #>  [809,] 1.0434646 #>  [810,] 0.8677967 #>  [811,] 0.8975052 #>  [812,] 1.2350066 #>  [813,] 1.1832141 #>  [814,] 1.0912697 #>  [815,] 0.8786651 #>  [816,] 1.1802556 #>  [817,] 0.9997761 #>  [818,] 1.0283237 #>  [819,] 1.0751476 #>  [820,] 1.1621728 #>  [821,] 0.8796320 #>  [822,] 1.1534975 #>  [823,] 1.1521143 #>  [824,] 1.0234950 #>  [825,] 0.8302094 #>  [826,] 1.1194667 #>  [827,] 0.8590939 #>  [828,] 1.0383962 #>  [829,] 0.9671301 #>  [830,] 1.0118804 #>  [831,] 1.0777867 #>  [832,] 0.9300983 #>  [833,] 0.9490566 #>  [834,] 0.7948762 #>  [835,] 0.8891419 #>  [836,] 0.9252264 #>  [837,] 0.7875442 #>  [838,] 1.0576789 #>  [839,] 1.0984919 #>  [840,] 1.0368720 #>  [841,] 1.1117642 #>  [842,] 0.9976047 #>  [843,] 1.1044067 #>  [844,] 1.1457548 #>  [845,] 1.0102531 #>  [846,] 0.9824804 #>  [847,] 0.8035122 #>  [848,] 1.2969094 #>  [849,] 1.2046737 #>  [850,] 0.7509912 #>  [851,] 0.8465392 #>  [852,] 1.0494275 #>  [853,] 1.0485819 #>  [854,] 0.8912908 #>  [855,] 0.9286151 #>  [856,] 0.9727813 #>  [857,] 0.9379492 #>  [858,] 1.1473590 #>  [859,] 0.9963303 #>  [860,] 0.7729862 #>  [861,] 1.0197192 #>  [862,] 0.9335764 #>  [863,] 0.8279961 #>  [864,] 0.9141928 #>  [865,] 0.8623137 #>  [866,] 0.8592586 #>  [867,] 0.8152158 #>  [868,] 1.0217109 #>  [869,] 1.0086641 #>  [870,] 1.2473172 #>  [871,] 0.7632532 #>  [872,] 0.8912582 #>  [873,] 0.9716137 #>  [874,] 0.8725044 #>  [875,] 0.9988815 #>  [876,] 0.8504251 #>  [877,] 0.9663205 #>  [878,] 0.8824298 #>  [879,] 1.0333707 #>  [880,] 0.9540832 #>  [881,] 0.8894562 #>  [882,] 0.8567155 #>  [883,] 1.0641599 #>  [884,] 0.8712263 #>  [885,] 0.9938430 #>  [886,] 0.9226532 #>  [887,] 1.1368500 #>  [888,] 1.0398418 #>  [889,] 1.0727859 #>  [890,] 0.7938929 #>  [891,] 0.8766771 #>  [892,] 1.0167152 #>  [893,] 0.8326852 #>  [894,] 1.2267530 #>  [895,] 0.9727010 #>  [896,] 0.8597765 #>  [897,] 1.1000598 #>  [898,] 1.2152017 #>  [899,] 0.8824817 #>  [900,] 0.8838340 #>  [901,] 1.0479865 #>  [902,] 0.8393248 #>  [903,] 1.0350844 #>  [904,] 1.0283613 #>  [905,] 0.7987114 #>  [906,] 0.9365128 #>  [907,] 0.9104385 #>  [908,] 0.9940481 #>  [909,] 0.8778923 #>  [910,] 0.8364829 #>  [911,] 0.8519052 #>  [912,] 1.0933607 #>  [913,] 0.8143084 #>  [914,] 1.0449954 #>  [915,] 1.1531685 #>  [916,] 0.9386542 #>  [917,] 0.8462519 #>  [918,] 1.0192954 #>  [919,] 0.9417132 #>  [920,] 1.0475192 #>  [921,] 1.0042855 #>  [922,] 1.2384760 #>  [923,] 1.2064411 #>  [924,] 0.6809973 #>  [925,] 1.0170555 #>  [926,] 0.9831414 #>  [927,] 1.0229351 #>  [928,] 0.9354371 #>  [929,] 0.9720062 #>  [930,] 1.0233275 #>  [931,] 0.8503376 #>  [932,] 1.0068106 #>  [933,] 0.7747047 #>  [934,] 1.0069018 #>  [935,] 0.9772676 #>  [936,] 0.9505398 #>  [937,] 1.2391216 #>  [938,] 1.0482216 #>  [939,] 1.1753096 #>  [940,] 1.1511425 #>  [941,] 0.8329854 #>  [942,] 0.8985835 #>  [943,] 0.9972231 #>  [944,] 1.0345269 #>  [945,] 0.7464593 #>  [946,] 0.9236145 #>  [947,] 0.8450773 #>  [948,] 0.7635340 #>  [949,] 0.8245044 #>  [950,] 0.9587403 #>  [951,] 0.9686015 #>  [952,] 1.1595343 #>  [953,] 0.8285553 #>  [954,] 0.9596193 #>  [955,] 0.8879619 #>  [956,] 1.0289656 #>  [957,] 0.8465588 #>  [958,] 1.1141169 #>  [959,] 1.0531825 #>  [960,] 0.9334763 #>  [961,] 0.8941001 #>  [962,] 0.9494101 #>  [963,] 0.9077426 #>  [964,] 0.7437924 #>  [965,] 1.1443753 #>  [966,] 1.0039831 #>  [967,] 0.9405682 #>  [968,] 0.9262141 #>  [969,] 1.1092539 #>  [970,] 0.9111281 #>  [971,] 1.0020443 #>  [972,] 0.9512418 #>  [973,] 0.9567531 #>  [974,] 0.8476751 #>  [975,] 0.9738218 #>  [976,] 0.8264467 #>  [977,] 1.0444977 #>  [978,] 0.9747068 #>  [979,] 1.1219858 #>  [980,] 1.0300285 #>  [981,] 0.8694738 #>  [982,] 1.0675826 #>  [983,] 0.9899005 #>  [984,] 0.9649526 #>  [985,] 0.9641293 #>  [986,] 0.9588028 #>  [987,] 1.1946726 #>  [988,] 0.8699311 #>  [989,] 1.0200620 #>  [990,] 1.1466958 #>  [991,] 1.0315619 #>  [992,] 0.8138703 #>  [993,] 1.1858885 #>  [994,] 1.1971052 #>  [995,] 0.9742069 #>  [996,] 0.9637449 #>  [997,] 0.9350503 #>  [998,] 1.0867579 #>  [999,] 0.9527127 #> [1000,] 0.8644189 # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_replicate_term_to_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract a term and replicates it randomN times for each linear model — extract_replicate_term_to_matrix","title":"Extract a term and replicates it randomN times for each linear model — extract_replicate_term_to_matrix","text":"Extract term replicates randomN times linear model. Used population mean variance terms.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_replicate_term_to_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract a term and replicates it randomN times for each linear model — extract_replicate_term_to_matrix","text":"","code":"extract_replicate_term_to_matrix(object, term)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_replicate_term_to_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract a term and replicates it randomN times for each linear model — extract_replicate_term_to_matrix","text":"object object class cumhist term String, term name","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_replicate_term_to_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract a term and replicates it randomN times for each linear model — extract_replicate_term_to_matrix","text":"Matrix","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_replicate_term_to_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract a term and replicates it randomN times for each linear model — extract_replicate_term_to_matrix","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock, state = \"State\", duration = \"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.481 seconds (Warm-up) #> Chain 1:                5.766 seconds (Sampling) #> Chain 1:                11.247 seconds (Total) #> Chain 1:  bH_mu <- extract_replicate_term_to_matrix(br_fit, \"bH_mu\") # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_term_to_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Extracts a term with one column per fixed or random-level into a matrix — extract_term_to_matrix","title":"Extracts a term with one column per fixed or random-level into a matrix — extract_term_to_matrix","text":"Extracts 3D array term  sample, linear-model, random/fixed-effect order returns matrix samples rows columns order 1) random/fixed effects lm1, 2) random/fixed effects lm2, etc.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_term_to_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extracts a term with one column per fixed or random-level into a matrix — extract_term_to_matrix","text":"","code":"extract_term_to_matrix(object, term)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_term_to_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extracts a term with one column per fixed or random-level into a matrix — extract_term_to_matrix","text":"object object class cumhist term String, term name","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_term_to_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extracts a term with one column per fixed or random-level into a matrix — extract_term_to_matrix","text":"Matrix","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/extract_term_to_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extracts a term with one column per fixed or random-level into a matrix — extract_term_to_matrix","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock, state = \"State\", duration = \"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.266 seconds (Warm-up) #> Chain 1:                4.908 seconds (Sampling) #> Chain 1:                10.174 seconds (Total) #> Chain 1:  a <- extract_term_to_matrix(br_fit, \"a\") # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fast_history_compute.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes cumulative history — fast_history_compute","title":"Computes cumulative history — fast_history_compute","text":"Computes cumulative history based common history values normalized_tau mixed_state defined random cluster / individual.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fast_history_compute.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes cumulative history — fast_history_compute","text":"","code":"fast_history_compute(df, normalized_tau, mixed_state, history_init)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fast_history_compute.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes cumulative history — fast_history_compute","text":"df DataFrame \"state\" (integer, 1 2 clear state, 3 - mixed state), \"duration\" (double), \"irandom\" (integer, 1-based index random cluster), \"run_start\" (integer, 1 first entry run, 0 otherwise), \"session_tmean\" (double) normalized_tau DoubleVector normalized tau value random cluster / individual. Thus, length must equal number unique indexes df[\"irandom\"]. mixed_state DoubleVector values used mixed state random cluster / individual. Thus, length must equal number unique indexes df[\"irandom\"]. history_init DoubleVector, size 2. Initial values history run.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fast_history_compute.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes cumulative history — fast_history_compute","text":"NumericMatrix, size df.nrows() × 2. Computed history values state.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fast_history_compute.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computes cumulative history — fast_history_compute","text":"","code":"df <- preprocess_data(br_singleblock, state=\"State\", duration=\"Duration\") fast_history_compute(df, 1, 0.5, c(0, 0)) #>            [,1]      [,2] #>  [1,] 0.0000000 0.0000000 #>  [2,] 0.4376245 0.0000000 #>  [3,] 0.2248001 0.4863174 #>  [4,] 0.5370311 0.2904410 #>  [5,] 0.3175173 0.5804763 #>  [6,] 0.7942799 0.1749725 #>  [7,] 0.3132936 0.6745784 #>  [8,] 0.7598867 0.2358726 #>  [9,] 0.3433397 0.6547442 #> [10,] 0.6965069 0.3026075 #> [11,] 0.2560426 0.7436319 #> [12,] 0.8299162 0.1700093 #> [13,] 0.2604354 0.7395412 #> [14,] 0.7793057 0.2206873 #> [15,] 0.2923041 0.7076933 #> [16,] 0.7242782 0.2757208 #> [17,] 0.2635858 0.7364139 #> [18,] 0.6656717 0.3343282 #> [19,] 0.2860841 0.7139159 #> [20,] 0.6830619 0.3169381 #> [21,] 0.2687481 0.7312519 #> [22,] 0.7078426 0.2921574 #> [23,] 0.2382783 0.7617217 #> [24,] 0.7680728 0.2319272 #> [25,] 0.2852782 0.7147218 #> [26,] 0.7072458 0.2927542 #> [27,] 0.1819388 0.8180612 #> [28,] 0.7432848 0.2567152 #> [29,] 0.1750940 0.8249060 #> [30,] 0.8001760 0.1998240 #> [31,] 0.3180102 0.6819898 #> [32,] 0.7615359 0.2384641 #> [33,] 0.2914458 0.7085542 #> [34,] 0.7596148 0.2403852 #> [35,] 0.2034366 0.7965634 #> [36,] 0.6951489 0.3048511 #> [37,] 0.2406317 0.7593683 #> [38,] 0.8414246 0.1585754 #> [39,] 0.2346019 0.7653981 #> [40,] 0.7297327 0.2702673 #> [41,] 0.3873127 0.6126873 #> [42,] 0.6004087 0.3995913 #> [43,] 0.2392187 0.7607813 #> [44,] 0.8170950 0.1829050 #> [45,] 0.2943872 0.7056128 #> [46,] 0.8273447 0.1726553 #> [47,] 0.4390107 0.5609893 #> [48,] 0.5861278 0.4138722 #> [49,] 0.5578937 0.4421063 #> [50,] 0.3460013 0.6539987 #> [51,] 0.4304187 0.5695813 #> [52,] 0.6422788 0.3577212 #> [53,] 0.2552579 0.7447421 #> [54,] 0.6971667 0.3028333 #> [55,] 0.1779976 0.8220024 #> [56,] 0.8571432 0.1428568 #> [57,] 0.3151733 0.6848267 #> [58,] 0.4343504 0.5656496 #> [59,] 0.4702628 0.5297372 #> [60,] 0.6474848 0.3525152 #> [61,] 0.2304212 0.7695788 #> [62,] 0.6194160 0.3805840 #> [63,] 0.3033325 0.6966675 #> [64,] 0.7791682 0.2208318 #> [65,] 0.2123805 0.7876195 #> [66,] 0.6503417 0.3496583 #> [67,] 0.2997422 0.7002578 #> [68,] 0.7951472 0.2048528 #> [69,] 0.2108206 0.7891794 #> [70,] 0.8029713 0.1970287 #> [71,] 0.1445517 0.8554483 #> [72,] 0.8513307 0.1486693 #> [73,] 0.2774292 0.7225708 #> [74,] 0.7645307 0.2354693 #> [75,] 0.2153185 0.7846815 #> [76,] 0.8174648 0.1825352"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fit_cumhist.html","id":null,"dir":"Reference","previous_headings":"","what":"Fits cumulative history for bistable perceptual rivalry displays. — fit_cumhist","title":"Fits cumulative history for bistable perceptual rivalry displays. — fit_cumhist","text":"Fits generalized linear model using cumulative history specified fixed effects.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fit_cumhist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fits cumulative history for bistable perceptual rivalry displays. — fit_cumhist","text":"","code":"fit_cumhist(   data,   state,   duration = NULL,   onset = NULL,   random_effect = NULL,   session = NULL,   run = NULL,   fixed_effects = NULL,   tau = NULL,   mixed_state = 0.5,   history_init = 0,   family = \"gamma\",   history_priors = NULL,   intercept_priors = NULL,   history_effect_prior = NULL,   fixed_effects_priors = NULL,   chains = 1,   cores = NULL,   ... )"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fit_cumhist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fits cumulative history for bistable perceptual rivalry displays. — fit_cumhist","text":"data table time-series. state String, name column specifies perceptual state. column type factor two three levels (third level assumed correspond transition/mixed phase) convertible two level factor (impossible infer identity transition/ mixed phase). duration String, name column duration individual perceptual dominance phases. Optional, can specify onset instead. onset String, name column onsets perceptual dominance states. Optional, used compute duration dominance phases, provided explicitly via duration parameter. random_effect String, name column identifies random effect, e.g. individual participants, stimuli single participant, etc. omitted, random effect assumed. specified one level (participant, stimulus, etc.), used hierarchical model. session String, name column identifies unique experimental session mean dominance phase duration computed (see norm_tau parameter). Code assumes session IDs different within participant can . omitted, single mean dominance duration based entire time series used. run String, name column identifies unique runs/blocks. omitted, data assumed belong single time series. Code assumes run IDs different within experimental session can session. E.g. session , runs 1, 2, 3.. session B, runs 1, 2, 3 session , runs 1, 2, 1. fixed_effects String vector strings. Name column(s) values used fitting additional fixed effect(s). E.g., contrast binocular rivalry, rotation speed kinetic-depth effect, etc. tau Time constant exponential growth/decay normalized mean duration clear percepts within session. Can 1) single positive number (>0) used participants runs, 2) NULL (default) -  single value fitted participants runs, 3) \"random\" - independent tau fitted random cluster, 4) \"1|random\"- tau random cluster sampled population distribution, .e., pooled parameter values via multilevel model. mixed_state Specifies activation level transition/mixed phases (state #3, see state). Either single number (range 0..1) used fixed level vector two numbers c(mu, kappa) specifies, correspondingly, mean (range 0..1) precision (>0) beta proportion distribution, sampled . Defaults fixed value 0.5. history_init Initial value cumulative history computation. Either numeric scalar 0..1 range vector two numbers 0..1 range. latter case, two histories start different levels. family String, distribution used fit duration perceptual dominance phases. Options include \"gamma\" (default), \"lognormal\", \"normal\". history_priors Named list optional priors population-level cumulative history parameters. Must follow format list(\"tau\"=c(1, 0.15)) values coding mean standard deviation normal distribution. intercept_priors vector optional priors population-level intercept parameter. c(<shape-mean>, <shape-sd>, <scale-mean>, <scale-sd>) format Gamma family, c(<mean>, <sd>) normal lognormal families. values code mean standard deviation normal distribution. history_effect_prior vector options priors population-level slope history effect. values code mean standard deviation normal distribution. Defaults mu=0, sigma=1. fixed_effects_priors named list optional priors fixed effects. Must follow format list(\"<name--variable>\"=c(<mu>, <sigma>)), <mu> <sigma> mean standard deviation normal distribution. Defaults mu=0, sigma=1. chains Number chains sampling. cores Number CPU cores use sampling. omitted, cores used. ... Additional arguments passed rstan::sampling() function.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fit_cumhist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fits cumulative history for bistable perceptual rivalry displays. — fit_cumhist","text":"object class cumhist","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fit_cumhist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fits cumulative history for bistable perceptual rivalry displays. — fit_cumhist","text":"","code":"# \\donttest{ data(br_singleblock) gamma_fit <- fit_cumhist(br_singleblock, state = \"State\", duration = \"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0.001 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 10 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.242 seconds (Warm-up) #> Chain 1:                5.75 seconds (Sampling) #> Chain 1:                10.992 seconds (Total) #> Chain 1:  # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fixef.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract the fixed-effects estimates — fixef","title":"Extract the fixed-effects estimates — fixef","text":"Extracts models fixed-effect terms every modeled distribution parameter.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fixef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract the fixed-effects estimates — fixef","text":"","code":"fixef(object, summary = TRUE, probs = c(0.055, 0.945))"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fixef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract the fixed-effects estimates — fixef","text":"object object class cumhist summary Whether summary statistics returned instead raw sample values. Defaults TRUE probs percentiles used compute summary, defaults 89% credible interval.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fixef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract the fixed-effects estimates — fixef","text":"tibble values summary, NULL fixed effects used.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/fixef.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract the fixed-effects estimates — fixef","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock,                       state = \"State\",                       duration = \"Duration\",                       fixed_effects = \"Time\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 53.428 seconds (Warm-up) #> Chain 1:                137.809 seconds (Sampling) #> Chain 1:                191.237 seconds (Total) #> Chain 1:  #> Warning: There were 942 transitions after warmup that exceeded the maximum treedepth. Increase max_treedepth above 10. See #> http://mc-stan.org/misc/warnings.html#maximum-treedepth-exceeded #> Warning: There were 1 chains where the estimated Bayesian Fraction of Missing Information was low. See #> http://mc-stan.org/misc/warnings.html#bfmi-low #> Warning: Examine the pairs() plot to diagnose sampling problems #> Warning: The largest R-hat is 2.12, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> http://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> http://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> http://mc-stan.org/misc/warnings.html#tail-ess fixef(br_fit) #> # A tibble: 2 x 5 #>   DistributionParameter Term  Estimate    `5.5%`   `94.5%` #>   <fct>                 <fct>    <dbl>     <dbl>     <dbl> #> 1 shape                 Time   0.00353  0.000617  0.00651  #> 2 scale                 Time  -0.00328 -0.00622  -0.000183 # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/historyef.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract the history-effects estimates — historyef","title":"Extract the history-effects estimates — historyef","text":"Extracts models population-level coefficients history-specific terms every modeled distribution parameter.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/historyef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract the history-effects estimates — historyef","text":"","code":"historyef(object, summary = TRUE, probs = c(0.055, 0.945))"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/historyef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract the history-effects estimates — historyef","text":"object object class cumhist summary Whether summary statistics returned instead raw sample values. Defaults TRUE probs percentiles used compute summary, defaults 89% credible interval.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/historyef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract the history-effects estimates — historyef","text":"data.frame values summary","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/historyef.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract the history-effects estimates — historyef","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock, state=\"State\", duration=\"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.149 seconds (Warm-up) #> Chain 1:                4.936 seconds (Sampling) #> Chain 1:                10.085 seconds (Total) #> Chain 1:  historyef(br_fit) #> # A tibble: 2 x 4 #>   DistributionParameter Estimate  `5.5%` `94.5%` #>   <fct>                    <dbl>   <dbl>   <dbl> #> 1 shape                    1.03   0.0316    2.01 #> 2 scale                    0.287 -0.781     1.41 # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_mixed_state.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract values of used or fitted history parameter mixed_state — history_mixed_state","title":"Extract values of used or fitted history parameter mixed_state — history_mixed_state","text":"short-cut history_parameter(object, \"mixed_state\", ...).","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_mixed_state.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract values of used or fitted history parameter mixed_state — history_mixed_state","text":"","code":"history_mixed_state(   object,   summary = TRUE,   probs = c(0.055, 0.945),   includePopulationLevel = TRUE )"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_mixed_state.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract values of used or fitted history parameter mixed_state — history_mixed_state","text":"object object class cumhist summary Whether summary statistics returned instead raw sample values. Defaults TRUE probs percentiles used compute summary, defaults 89% credible interval. includePopulationLevel Logical, pooled random effect . Whether include population mean separate \"_population\" level, default TRUE.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_mixed_state.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract values of used or fitted history parameter mixed_state — history_mixed_state","text":"single value, fixed value used. vector tibble, depending option used (single intercept, independent random intercepts), whether summary requested.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_mixed_state.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract values of used or fitted history parameter mixed_state — history_mixed_state","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock, state=\"State\", duration=\"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.386 seconds (Warm-up) #> Chain 1:                6.066 seconds (Sampling) #> Chain 1:                11.452 seconds (Total) #> Chain 1:  history_tau(br_fit) #> # A tibble: 1 x 3 #>   Estimate `5.5%` `94.5%` #>      <dbl>  <dbl>   <dbl> #> 1    0.969  0.781    1.19 # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_parameter.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract values of used or fitted history parameter — history_parameter","title":"Extract values of used or fitted history parameter — history_parameter","text":"Extract values used fitted history parameter","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_parameter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract values of used or fitted history parameter — history_parameter","text":"","code":"history_parameter(   object,   param,   summary = TRUE,   probs = c(0.055, 0.945),   includePopulationLevel = TRUE )"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_parameter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract values of used or fitted history parameter — history_parameter","text":"object object class cumhist param Parameter name: \"tau\" \"mixed_state\" summary Whether summary statistics returned instead raw sample values. Defaults TRUE probs percentiles used compute summary, defaults 89% credible interval. includePopulationLevel Logical, pooled random effect . Whether include population mean separate \"_population\" level, default TRUE.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_parameter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract values of used or fitted history parameter — history_parameter","text":"vector, summary requested. tibble summary fixed value used.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_parameter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract values of used or fitted history parameter — history_parameter","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock, state=\"State\", duration=\"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.646 seconds (Warm-up) #> Chain 1:                5.533 seconds (Sampling) #> Chain 1:                11.179 seconds (Total) #> Chain 1:  history_parameter(br_fit, \"tau\") #> # A tibble: 1 x 3 #>   Estimate `5.5%` `94.5%` #>      <dbl>  <dbl>   <dbl> #> 1    0.998  0.797    1.23 # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_tau.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract values of used or fitted history parameter tau — history_tau","title":"Extract values of used or fitted history parameter tau — history_tau","text":"short-cut history_parameter(object, \"tau\", ...).","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_tau.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract values of used or fitted history parameter tau — history_tau","text":"","code":"history_tau(   object,   summary = TRUE,   probs = c(0.055, 0.945),   includePopulationLevel = TRUE )"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_tau.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract values of used or fitted history parameter tau — history_tau","text":"object object class cumhist summary Whether summary statistics returned instead raw sample values. Defaults TRUE probs percentiles used compute summary, defaults 89% credible interval. includePopulationLevel Logical, pooled random effect . Whether include population mean separate \"_population\" level, default TRUE.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_tau.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract values of used or fitted history parameter tau — history_tau","text":"single value, fixed value used. vector tibble, depending option used (single intercept, independent random intercepts), whether summary requested.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/history_tau.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract values of used or fitted history parameter tau — history_tau","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock, state=\"State\", duration=\"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.252 seconds (Warm-up) #> Chain 1:                5.304 seconds (Sampling) #> Chain 1:                10.556 seconds (Total) #> Chain 1:  history_tau(br_fit) #> # A tibble: 1 x 3 #>   Estimate `5.5%` `94.5%` #>      <dbl>  <dbl>   <dbl> #> 1    0.986  0.779    1.22 # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/kde.html","id":null,"dir":"Reference","previous_headings":"","what":"Kinetic-depth effect data — kde","title":"Kinetic-depth effect data — kde","text":"Dataset kinetic-depth effect eleven participants.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/kde.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Kinetic-depth effect data — kde","text":"","code":"kde"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/kde.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Kinetic-depth effect data — kde","text":"data frame 38698 rows 6 variables: Observer Participant ID. Display Display, rows contain \"KD\" Block Run / block index. Time Time relative run onset seconds State Factor levels \"Left\", \"Right\" (clear states), \"Mixed\" Duration Duration dominance phase seconds. Note duration last dominance phase curtailed , therefore, set zero.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/kde.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Kinetic-depth effect data — kde","text":"doi: 10.1167/11.10.12","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/kde_two_observers.html","id":null,"dir":"Reference","previous_headings":"","what":"Multirun data for two participants, kinetic-depth effect display — kde_two_observers","title":"Multirun data for two participants, kinetic-depth effect display — kde_two_observers","text":"Multirun data two participants, kinetic-depth effect display","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/kde_two_observers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multirun data for two participants, kinetic-depth effect display — kde_two_observers","text":"","code":"kde_two_observers"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/kde_two_observers.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Multirun data for two participants, kinetic-depth effect display — kde_two_observers","text":"data frame 1186 rows 5 variables: Observer Participant ID Block Run / block index State Factor variable state levels -1 1 coding two clear perceptual states -2 mixed / transition phase Time Time relative run onset seconds Duration Duration dominance phase seconds. Note duration last dominance phase curtailed , therefore, set zero.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/kde_two_observers.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Multirun data for two participants, kinetic-depth effect display — kde_two_observers","text":"doi: 10.1167/11.10.12","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/loo.cumhist.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes an efficient approximate leave-one-out\r\ncross-validation via loo library. It can be used\r\nfor a model comparison via loo::loo_compare() function. — loo.cumhist","title":"Computes an efficient approximate leave-one-out\r\ncross-validation via loo library. It can be used\r\nfor a model comparison via loo::loo_compare() function. — loo.cumhist","text":"Computes efficient approximate leave-one-cross-validation via loo library. can used model comparison via loo::loo_compare() function.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/loo.cumhist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes an efficient approximate leave-one-out\r\ncross-validation via loo library. It can be used\r\nfor a model comparison via loo::loo_compare() function. — loo.cumhist","text":"","code":"# S3 method for cumhist loo(x, ...)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/loo.cumhist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes an efficient approximate leave-one-out\r\ncross-validation via loo library. It can be used\r\nfor a model comparison via loo::loo_compare() function. — loo.cumhist","text":"x cumhist object ... unused","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/loo.cumhist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes an efficient approximate leave-one-out\r\ncross-validation via loo library. It can be used\r\nfor a model comparison via loo::loo_compare() function. — loo.cumhist","text":"named list, see loo::loo() details.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/loo.cumhist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computes an efficient approximate leave-one-out\r\ncross-validation via loo library. It can be used\r\nfor a model comparison via loo::loo_compare() function. — loo.cumhist","text":"","code":"data(br_singleblock) # \\donttest{ gamma_fit <- fit_cumhist(br_singleblock, state=\"State\", duration=\"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.465 seconds (Warm-up) #> Chain 1:                5.954 seconds (Sampling) #> Chain 1:                11.419 seconds (Total) #> Chain 1:  loo_gamma <- loo(gamma_fit) #> Warning: Some Pareto k diagnostic values are too high. See help('pareto-k-diagnostic') for details. # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/nc.html","id":null,"dir":"Reference","previous_headings":"","what":"Necker cube data — nc","title":"Necker cube data — nc","text":"Dataset Necker cube five participants.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/nc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Necker cube data — nc","text":"","code":"nc"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/nc.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Necker cube data — nc","text":"data frame 3464 rows 6 variables: Observer Participant ID. Display Display, rows contain \"NC\" Block Run / block index. Time Time relative run onset seconds State Factor levels \"Left\", \"Right\" (clear states), \"Mixed\" Duration Duration dominance phase seconds. Note duration last dominance phase curtailed , therefore, set zero.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/nc.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Necker cube data — nc","text":"doi: 10.1167/11.10.12","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/predict.cumhist.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes predicted dominance phase durations using posterior predictive distribution. — predict.cumhist","title":"Computes predicted dominance phase durations using posterior predictive distribution. — predict.cumhist","text":"Computes predicted dominance phase durations using fitted model. Returns predicted values dominance phases marked use. .e., excluding first last dominance phases, mixed phases, etc. See preprocess_data().","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/predict.cumhist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes predicted dominance phase durations using posterior predictive distribution. — predict.cumhist","text":"","code":"# S3 method for cumhist predict(object, summary = TRUE, probs = NULL, full_length = TRUE, ...)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/predict.cumhist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes predicted dominance phase durations using posterior predictive distribution. — predict.cumhist","text":"object object class cumhist summary Whether summary statistics returned instead raw sample values. Defaults TRUE probs percentiles used compute summary, defaults NULL (CI). full_length summary = TRUE, whether summary table include rows predictions. .e., rows mixed phases, first/last dominance phase run, etc. See preprocess_data(). Defaults TRUE. ... Unused","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/predict.cumhist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes predicted dominance phase durations using posterior predictive distribution. — predict.cumhist","text":"summary=FALSE, numeric matrix iterationsN x clearN. summary=TRUE probs=NULL vector mean predicted durations. summary=TRUE probs NULL, data.frame column \"Predicted\" (mean) column specified quantile.","code":""},{"path":[]},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/predict.cumhist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computes predicted dominance phase durations using posterior predictive distribution. — predict.cumhist","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock, state = \"State\", duration = \"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.314 seconds (Warm-up) #> Chain 1:                5.383 seconds (Sampling) #> Chain 1:                10.697 seconds (Total) #> Chain 1:  predict(br_fit) #>  [1]       NA       NA 3.115101 3.046974 3.113919 4.985647 3.555326 4.399008 #>  [9] 3.326157 3.703920 4.188773 5.262398 4.149869 4.606387 3.814127 3.983115 #> [17] 4.110201 3.415454 3.871155 3.572793 4.054659 3.813754 4.395210 4.469618 #> [25] 3.886945 3.807004 5.097451 4.190567 5.193883 4.863715 3.570084 4.390248 #> [33] 3.822666 4.371503 4.816753 3.694116 4.366893 5.420727 4.442148 4.043879 #> [41] 2.969304 2.867542 4.379062 5.085853 3.797355 5.226328 2.601666       NA #> [49] 2.559659       NA 2.631236 3.211097 4.197412 3.710015 5.152264 5.649225 #> [57] 3.599596       NA 2.374491 3.251562 4.482573 3.027451 3.696368 4.598951 #> [65] 4.707976 3.283452 3.733558 4.797116 4.727108 4.901587 5.626547 5.564656 #> [73] 3.972457 4.429045 4.668272       NA  # full posterior prediction samples predictions_samples <- predict(br_fit, summary=FALSE) # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/predict_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes prediction for a each sample. — predict_samples","title":"Computes prediction for a each sample. — predict_samples","text":"Computing prediction sample, recomputing cumulative history uses fitted parameter values.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/predict_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes prediction for a each sample. — predict_samples","text":"","code":"predict_samples(   family,   fixedN,   randomN,   lmN,   istate,   duration,   is_used,   run_start,   session_tmean,   irandom,   fixed,   tau_ind,   mixed_state_ind,   history_init,   a,   bH,   bF,   sigma )"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/predict_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes prediction for a each sample. — predict_samples","text":"family int, distribution family: gamma (1), lognormal(2), normal (3). fixedN int, number fixed parameters (>= 0). randomN int, number random factors (>= 1). lmN int, number linear models (>= 1). istate IntegerVector, zero-based perceptual state 0 1, 2 mixed state. duration DoubleVector, duration dominance phase. is_used IntegerVector, whether dominance phase used prediction (1) (0). run_start IntegerVector, 1 whenever new run starts. session_tmean DoubleVector, average dominance phase duration. irandom IntegerVector, zero-based index random effect. fixed NumericMatrix, matrix fixed effect values. tau_ind NumericMatrix, matrix samples tau random level. mixed_state_ind NumericMatrix, matrix samples mixed_state random level. history_init DoubleVector, Initial values history run NumericMatrix, matrix samples (intercept) random level. bH NumericMatrix, matrix sample bH linear model random level. bF NumericMatrix, matrix sample bF linear model fixed factor. sigma DoubleVector, samples sigma.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/predict_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes prediction for a each sample. — predict_samples","text":"NumericMatrix predicted durations sample.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/preprocess_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Preprocesses time-series data for fitting — preprocess_data","title":"Preprocesses time-series data for fitting — preprocess_data","text":"Performs sanity checks (e.g., whether data can used data.frame), computes duration dominance phases (necessary), assumes single entry missing session, run, random_effect.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/preprocess_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Preprocesses time-series data for fitting — preprocess_data","text":"","code":"preprocess_data(   data,   state,   duration = NULL,   onset = NULL,   random_effect = NULL,   session = NULL,   run = NULL )"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/preprocess_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Preprocesses time-series data for fitting — preprocess_data","text":"data table one many time-series. state String, name column specifies perceptual state. column type factor two three levels (third level assumed correspond transition/mixed phase) convertible two level factor (impossible infer identity transition/ mixed phase). duration String, name column duration individual perceptual dominance phases. Optional, can specify onset instead. onset String, name column onsets perceptual dominance states. Optional, used compute duration dominance phases, provided explicitly via duration parameter. random_effect String, name column identifies random effect, e.g. individual participants, stimuli single participant, etc. omitted, random effect assumed. specified one level (participant, stimulus, etc.), used hierarchical model. session String, name column identifies unique experimental session mean dominance phase duration computed (see norm_tau parameter). Code assumes session IDs different within participant can . omitted, single mean dominance duration based entire time series used. run String, name column identifies unique runs/blocks. omitted, data assumed belong single time series. Code assumes run IDs different within experimental session can session. E.g. session , runs 1, 2, 3.. session B, runs 1, 2, 3 session , runs 1, 2, 1.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/preprocess_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Preprocesses time-series data for fitting — preprocess_data","text":"tibble columns state duration random irandom - integer, index random values, session run session_tmean - numeric, mean duration clear percepts every combination random session. is_used - integer, whether computed history value needs used linear model fitting. run_start - integer, 1 first row run time-series.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/preprocess_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Preprocesses time-series data for fitting — preprocess_data","text":"","code":"df <- preprocess_data(br_singleblock, state=\"State\", duration=\"Duration\")"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/print.cumhist.html","id":null,"dir":"Reference","previous_headings":"","what":"Prints out cumhist object — print.cumhist","title":"Prints out cumhist object — print.cumhist","text":"Prints cumhist object","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/print.cumhist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prints out cumhist object — print.cumhist","text":"","code":"# S3 method for cumhist print(x, ...)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/print.cumhist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prints out cumhist object — print.cumhist","text":"x cumhist object ... Unused","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/print.cumhist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prints out cumhist object — print.cumhist","text":"Nothing, console output .","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/print.cumhist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prints out cumhist object — print.cumhist","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock, state=\"State\", duration=\"Duration\", fixed_effects=\"Time\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 26.669 seconds (Warm-up) #> Chain 1:                14.611 seconds (Sampling) #> Chain 1:                41.28 seconds (Total) #> Chain 1:  br_fit #> Call: fit_cumhist(data = br_singleblock, state = \"State\", duration = \"Duration\",  #>     fixed_effects = \"Time\") #>  #> Family: gamma # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/summary.cumhist.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary for a cumhist object — summary.cumhist","title":"Summary for a cumhist object — summary.cumhist","text":"Summary cumhist object","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/summary.cumhist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary for a cumhist object — summary.cumhist","text":"","code":"# S3 method for cumhist summary(object, ...)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/summary.cumhist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary for a cumhist object — summary.cumhist","text":"object cumhist object ... Unused","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/summary.cumhist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary for a cumhist object — summary.cumhist","text":"Nothing, console output .","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/summary.cumhist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary for a cumhist object — summary.cumhist","text":"","code":"# \\donttest{ br_fit <- fit_cumhist(br_singleblock, state=\"State\", duration=\"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.42 seconds (Warm-up) #> Chain 1:                5.413 seconds (Sampling) #> Chain 1:                10.833 seconds (Total) #> Chain 1:  summary(br_fit) #> Call: fit_cumhist(data = br_singleblock, state = \"State\", duration = \"Duration\") #>  #> Family: gamma #>  #> History parameters: #> tau = 0.98 #> mixed state = 0.5 #>  #> Linear model: #> # A tibble: 2 x 5 #>   DistributionParameter Term    Estimate  `5.5%` `94.5%` #>   <fct>                 <chr>      <dbl>   <dbl>   <dbl> #> 1 shape                 History    1.02   0.0886    2.00 #> 2 scale                 History    0.302 -0.816     1.44 # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/waic.cumhist.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes widely applicable information criterion\r\n(WAIC). — waic.cumhist","title":"Computes widely applicable information criterion\r\n(WAIC). — waic.cumhist","text":"Computes widely applicable information criterion via loo library. can used model comparison via loo::loo_compare() function.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/waic.cumhist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes widely applicable information criterion\r\n(WAIC). — waic.cumhist","text":"","code":"# S3 method for cumhist waic(x, ...)"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/waic.cumhist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes widely applicable information criterion\r\n(WAIC). — waic.cumhist","text":"x cumhist object. ... Additional arguments (unused)","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/waic.cumhist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes widely applicable information criterion\r\n(WAIC). — waic.cumhist","text":"named list, see loo::waic() details.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/reference/waic.cumhist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computes widely applicable information criterion\r\n(WAIC). — waic.cumhist","text":"","code":"# \\donttest{ data(br_singleblock) gamma_fit <- fit_cumhist(br_singleblock, state=\"State\", duration=\"Duration\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 5.18 seconds (Warm-up) #> Chain 1:                5.349 seconds (Sampling) #> Chain 1:                10.529 seconds (Total) #> Chain 1:  waic_gamma <- waic(gamma_fit) #> Warning:  #> 2 (2.9%) p_waic estimates greater than 0.4. We recommend trying loo instead. normal_fit <- fit_cumhist(br_singleblock, state=\"State\", duration=\"Duration\", family=\"normal\") #>  #> SAMPLING FOR MODEL 'historylm' NOW (CHAIN 1). #> Chain 1:  #> Chain 1: Gradient evaluation took 0 seconds #> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds. #> Chain 1: Adjust your expectations accordingly! #> Chain 1:  #> Chain 1:  #> Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup) #> Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup) #> Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup) #> Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup) #> Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup) #> Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup) #> Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling) #> Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling) #> Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling) #> Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling) #> Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling) #> Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling) #> Chain 1:  #> Chain 1:  Elapsed Time: 0.904 seconds (Warm-up) #> Chain 1:                0.95 seconds (Sampling) #> Chain 1:                1.854 seconds (Total) #> Chain 1:  waic_normal <- waic(normal_fit) #> Warning:  #> 1 (1.4%) p_waic estimates greater than 0.4. We recommend trying loo instead. loo::loo_compare(waic_gamma, waic_normal) #>        elpd_diff se_diff #> model2  0.0       0.0    #> model1 -2.7       4.4    # }"},{"path":"https://alexander-pastukhov.github.io/bistablehistory/news/index.html","id":"bistablehistory-100","dir":"Changelog","previous_headings":"","what":"bistablehistory 1.0.0","title":"bistablehistory 1.0.0","text":"CRAN release: 2021-09-28","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/news/index.html","id":"first-cran-release-1-0-0","dir":"Changelog","previous_headings":"","what":"First CRAN Release","title":"bistablehistory 1.0.0","text":"Initial CRAN Release","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/news/index.html","id":"bistablehistory-110","dir":"Changelog","previous_headings":"","what":"bistablehistory 1.1.0","title":"bistablehistory 1.1.0","text":"CRAN release: 2022-01-13","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/news/index.html","id":"improvements-1-1-0","dir":"Changelog","previous_headings":"","what":"Improvements","title":"bistablehistory 1.1.0","text":"Custom prior values history parameters, intercept terms, history effect, fixed effects. Simplified Stan code. predict() computes values history, reducing fit object size. predict() returns vector length matches original table.","code":""},{"path":"https://alexander-pastukhov.github.io/bistablehistory/news/index.html","id":"bug-fixes-1-1-0","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"bistablehistory 1.1.0","text":"Change difference history values instead weighted mean. Use scale instead rate prediction Gamma family. Spelling documentation. Additional tests.","code":""}]
